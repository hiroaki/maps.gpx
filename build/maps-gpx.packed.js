function MapsGPX(){this.initialize.apply(this,arguments)}function DrawerCSS(){this.initialize.apply(this,arguments)}function ExtDraggableObject(t,e){function n(e){e?t.style.cursor=M:t.style.cursor=E}function i(e,n,i){var r,o;g=Math.round(e),f=Math.round(n),x.intervalX>1&&(r=Math.round(g%x.intervalX),g=S>r?g-r:g+(x.intervalX-r)),x.intervalY>1&&(o=Math.round(f%x.intervalY),f=T>o?f-o:f+(x.intervalY-o)),x.container&&x.container.offsetWidth&&(g=Math.max(0,Math.min(g,x.container.offsetWidth-t.offsetWidth)),f=Math.max(0,Math.min(f,x.container.offsetHeight-t.offsetHeight))),"number"==typeof l&&(g-l>x.toleranceX||l-(g+t.offsetWidth)>x.toleranceX||f-h>x.toleranceY||h-(f+t.offsetHeight)>x.toleranceY)&&(g=v,f=b),x.restrictX||i||(t.style.left=g+"px"),x.restrictY||i||(t.style.top=f+"px")}function r(t){var e=t||event;l=c+((e.pageX||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft)-p),h=u+((e.pageY||e.clientY+document.body.scrollTop+document.documentElement.scrollTop)-d),c=l,u=h,p=e.pageX||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=e.pageY||e.clientY+document.body.scrollTop+document.documentElement.scrollTop,k&&(i(l,h,s),P.trigger(w,"drag",{mouseX:p,mouseY:d,startLeft:v,startTop:b,event:e}))}function o(e){var i=e||event;return n(!0),P.trigger(w,"mousedown",i),"absolute"!==t.style.position?void(t.style.position="absolute"):(p=i.pageX||i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=i.pageY||i.clientY+document.body.scrollTop+document.documentElement.scrollTop,v=t.offsetLeft,b=t.offsetTop,c=v,u=b,_=P.addDomListener(C,"mousemove",r),t.setCapture&&t.setCapture(),i.preventDefault?(i.preventDefault(),i.stopPropagation()):(i.cancelBubble=!0,i.returnValue=!1),k=!0,void P.trigger(w,"dragstart",{mouseX:p,mouseY:d,startLeft:v,startTop:b,event:i}))}function a(e){var i=e||event;k&&(n(!1),P.removeListener(_),t.releaseCapture&&t.releaseCapture(),k=!1,P.trigger(w,"dragend",{mouseX:p,mouseY:d,startLeft:v,startTop:b,event:i})),l=h=null,P.trigger(w,"mouseup",i)}var s,l,h,u,c,p,d,f,g,m,y,_,v,b,w=this,P=window.GEvent||google.maps.Event||google.maps.event,x=e||{},M=x.draggingCursor||"default",E=x.draggableCursor||"default",k=!1,S=Math.round(x.intervalX/2),T=Math.round(x.intervalY/2),C=t.setCapture?t:document;"number"!=typeof x.intervalX&&(x.intervalX=1),"number"!=typeof x.intervalY&&(x.intervalY=1),"number"!=typeof x.toleranceX&&(x.toleranceX=1/0),"number"!=typeof x.toleranceY&&(x.toleranceY=1/0),m=P.addDomListener(t,"mousedown",o),y=P.addDomListener(C,"mouseup",a),n(!1),x.container,t.style.position="absolute",x.left=x.left||t.offsetLeft,x.top=x.top||t.offsetTop,x.interval=x.interval||1,i(x.left,x.top,!1),w.moveTo=function(t){i(t.x,t.y,!1)},w.moveBy=function(e){i(t.offsetLeft+e.width,t.offsetHeight+e.height,!1)},w.setDraggingCursor=function(t){M=t,n(k)},w.setDraggableCursor=function(t){E=t,n(k)},w.left=function(){return g},w.top=function(){return f},w.valueX=function(){var t=x.intervalX||1;return Math.round(g/t)},w.valueY=function(){var t=x.intervalY||1;return Math.round(f/t)},w.setValueX=function(t){i(t*x.intervalX,f,!1)},w.setValueY=function(t){i(g,t*x.intervalY,!1)},w.preventDefaultMovement=function(t){s=t}}function MercatorProjection(){this.pixelOrigin_=new google.maps.Point(MercatorProjection.TILE_SIZE/2,MercatorProjection.TILE_SIZE/2),this.pixelsPerLonDegree_=MercatorProjection.TILE_SIZE/360,this.pixelsPerLonRadian_=MercatorProjection.TILE_SIZE/(2*Math.PI)}!function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";function i(){}function r(t){try{return t.then}catch(e){return m=e,y}}function o(t,e){try{return t(e)}catch(n){return m=n,y}}function a(t,e,n){try{t(e,n)}catch(i){return m=i,y}}function s(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._37=0,this._12=null,this._59=[],t!==i&&f(t,this)}function l(t,e,n){return new t.constructor(function(r,o){var a=new s(i);a.then(r,o),h(t,new d(e,n,a))})}function h(t,e){for(;3===t._37;)t=t._12;return 0===t._37?void t._59.push(e):void g(function(){var n=1===t._37?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._37?u(e.promise,t._12):c(e.promise,t._12));var i=o(n,t._12);i===y?c(e.promise,m):u(e.promise,i)})}function u(t,e){if(e===t)return c(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var n=r(e);if(n===y)return c(t,m);if(n===t.then&&e instanceof s)return t._37=3,t._12=e,void p(t);if("function"==typeof n)return void f(n.bind(e),t)}t._37=1,t._12=e,p(t)}function c(t,e){t._37=2,t._12=e,p(t)}function p(t){for(var e=0;e<t._59.length;e++)h(t,t._59[e]);t._59=null}function d(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function f(t,e){var n=!1,i=a(t,function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,c(e,t))});n||i!==y||(n=!0,c(e,m))}var g=t("asap/raw"),m=null,y={};e.exports=s,s._99=i,s.prototype.then=function(t,e){if(this.constructor!==s)return l(this,t,e);var n=new s(i);return h(this,new d(t,e,n)),n}},{"asap/raw":4}],2:[function(t,e,n){"use strict";function i(t){var e=new r(r._99);return e._37=1,e._12=t,e}var r=t("./core.js");e.exports=r;var o=i(!0),a=i(!1),s=i(null),l=i(void 0),h=i(0),u=i("");r.resolve=function(t){if(t instanceof r)return t;if(null===t)return s;if(void 0===t)return l;if(t===!0)return o;if(t===!1)return a;if(0===t)return h;if(""===t)return u;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new r(e.bind(t))}catch(n){return new r(function(t,e){e(n)})}return i(t)},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function i(a,s){if(s&&("object"==typeof s||"function"==typeof s)){if(s instanceof r&&s.then===r.prototype.then){for(;3===s._37;)s=s._12;return 1===s._37?i(a,s._12):(2===s._37&&n(s._12),void s.then(function(t){i(a,t)},n))}var l=s.then;if("function"==typeof l){var h=new r(l.bind(s));return void h.then(function(t){i(a,t)},n)}}e[a]=s,0===--o&&t(e)}if(0===e.length)return t([]);for(var o=e.length,a=0;a<e.length;a++)i(a,e[a])})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){t.forEach(function(t){r.resolve(t).then(e,n)})})},r.prototype["catch"]=function(t){return this.then(null,t)}},{"./core.js":1}],3:[function(t,e,n){"use strict";function i(){if(l.length)throw l.shift()}function r(t){var e;e=s.length?s.pop():new o,e.task=t,a(e)}function o(){this.task=null}var a=t("./raw"),s=[],l=[],h=a.makeRequestCallFromTimer(i);e.exports=r,o.prototype.call=function(){try{this.task.call()}catch(t){r.onerror?r.onerror(t):(l.push(t),h())}finally{this.task=null,s[s.length]=this}}},{"./raw":4}],4:[function(t,e,n){(function(t){"use strict";function n(t){s.length||(a(),l=!0),s[s.length]=t}function i(){for(;h<s.length;){var t=h;if(h+=1,s[t].call(),h>u){for(var e=0,n=s.length-h;n>e;e++)s[e]=s[e+h];s.length-=h,h=0}}s.length=0,h=0,l=!1}function r(t){var e=1,n=new c(t),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){e=-e,i.data=e}}function o(t){return function(){function e(){clearTimeout(n),clearInterval(i),t()}var n=setTimeout(e,0),i=setInterval(e,50)}}e.exports=n;var a,s=[],l=!1,h=0,u=1024,c=t.MutationObserver||t.WebKitMutationObserver;a="function"==typeof c?r(i):o(i),n.requestFlush=a,n.makeRequestCallFromTimer=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,n){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(t,e){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(t){setTimeout(function(){throw t},0)})})},{}],6:[function(t,e,n){t("asap");"undefined"==typeof Promise&&(Promise=t("./lib/core.js"),t("./lib/es6-extensions.js")),t("./polyfill-done.js")},{"./lib/core.js":1,"./lib/es6-extensions.js":2,"./polyfill-done.js":5,asap:3}]},{},[6]),MapsGPX.VERSION="4.3.0",MapsGPX.EXTENSIONS=["DescImage","DrawerCSS","Droppable","EXIF","EXIF2GPX","EXIFMarker","ElevationChart","Exporter","FileClip","GeoLocation","GeoLocationControl","InputFileControl","Milestone","QueryURL","SearchControl","SidePanelControl","ToggleOverlay","VertexInfo","VertexInfoWindow"],MapsGPX.ELEMENTS={AGEOFDGPSDATA:"ageofdgpsdata",AUTHOR:"author",BOUNDS:"bounds",CMT:"cmt",COPYRIGHT:"copyright",DESC:"desc",DGPSID:"dgpsid",ELE:"ele",EMAIL:"email",EXTENSIONS:"extensions",FIX:"fix",GEOIDHEIGHT:"geoidheight",GPX:"gpx",HDOP:"hdop",KEYWORDS:"keywords",LICENSE:"license",LINK:"link",MAGVAR:"magvar",METADATA:"metadata",NAME:"name",NUMBER:"number",PDOP:"pdop",PT:"pt",RTE:"rte",RTEPT:"rtept",SAT:"sat",SRC:"src",TEXT:"text",TIME:"time",TRK:"trk",TRKPT:"trkpt",TRKSEG:"trkseg",TYPE:"type",VDOP:"vdop",WPT:"wpt",YEAR:"year"},MapsGPX._sequence=0,MapsGPX.nextval=function(){return++MapsGPX._sequence},MapsGPX.strict=!0,MapsGPX.join_trkseg=!0,MapsGPX.cache_script=!0,MapsGPX.basedir=function(){var t,e,n,i=document.getElementsByTagName("script"),r=new RegExp("/maps-gpx.js.*");for(t=0,e=i.length;e>t;++t)if(n=i.item(t).getAttribute("src"),r.test(n))return n.replace(r,"");return"."}(),MapsGPX.plugin_dir=[MapsGPX.basedir,"plugins"].join("/"),MapsGPX.scrip_loader="loader.js",MapsGPX.style_loader="loader.css",MapsGPX.isSafari=function(){return/Version\/[\d\.]+.*Safari/.test(navigator.userAgent)?!0:!1},MapsGPX.merge=function(){var t,e,n,i=Array.prototype.slice.call(arguments),r=i[0]||{};for(t=1,e=i.length;e>t;++t)for(n in i[t])i[t].hasOwnProperty(n)&&(r[n]=i[t][n]);return r},MapsGPX.parseQueryString=function(t){var e,n,i,r,o,a={};if(t)for(e=t.match(/^\?/)?t.substring(1):t,n=e.split(/[;&]/),i=0,r=n.length;r>i;++i)o=n[i].split("="),o[0]&&(a[o[0]]=decodeURIComponent(o[1]));return a},MapsGPX.parseXML=function(t){if("undefined"!=typeof ActiveXObject&&"undefined"!=typeof GetObject){var e=new ActiveXObject("Microsoft.XMLDOM");return e.loadXML(t),e}if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(t,"text/xml");throw new Error("Cannot parse string as XML stream.")},MapsGPX.createXMLHttpRequest=function(){try{if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new XMLHttpRequest}catch(t){throw new Error("Cannot create XmlHttpRequest object.")}return null},MapsGPX.resolveAsBlob=function(t){return t instanceof Blob||t instanceof File?Promise.resolve(t):"string"==typeof t?new Promise(function(e,n){var i=MapsGPX.createXMLHttpRequest();i.open("GET",t,!0),i.responseType="blob",i.onload=function(t){4===this.readyState&&(200===this.status||0===this.status)&&e(this.response)},i.send()}):void 0},MapsGPX.resolveAsArrayBuffer=function(t){return MapsGPX.resolveAsBlob(t).then(function(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsArrayBuffer(t)})})},MapsGPX.resolveAsObjectURL=function(t){return MapsGPX.resolveAsBlob(t).then(function(t){return new Promise(function(e,n){e(URL.createObjectURL(t))})})},MapsGPX.resolveAsDataURL=function(t){return MapsGPX.resolveAsBlob(t).then(function(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsDataURL(t)})})},MapsGPX.resolveAsText=function(t,e){return MapsGPX.resolveAsBlob(t).then(function(t){return new Promise(function(n,i){var r=new FileReader;r.onload=function(t){n(t.target.result)},r.readAsText(t,e||"UTF-8")})})},MapsGPX.GPXToJSON=function(t){var e,n,i,r,o,a,s=function(t){var e,n,i={href:t.getAttribute("href")},r=t.childNodes;for(e=0,n=r.length;n>e;++e)r[e].firstChild&&(i[r[e].tagName]=r[e].firstChild.nodeValue);return i},l=function(t){var e,n,i,r={lat:t.getAttribute("lat"),lon:t.getAttribute("lon"),link:[]},o=t.childNodes;for(e=0,n=o.length;n>e;++e)i=o[e].tagName,i==MapsGPX.ELEMENTS.LINK?r[MapsGPX.ELEMENTS.LINK].push(s(o[e])):i!=MapsGPX.ELEMENTS.EXTENSIONS&&o[e].firstChild&&(r[o[e].tagName]=o[e].firstChild.nodeValue);return r},h=function(t){var e,n,i,r={rtept:[]},o=t.childNodes;for(e=0,n=o.length;n>e;++e)i=o[e].tagName,i==MapsGPX.ELEMENTS.RTEPT?r[MapsGPX.ELEMENTS.RTEPT].push(l(o[e])):i!=MapsGPX.ELEMENTS.EXTENSIONS&&o[e].firstChild&&(r[i]=o[e].firstChild.nodeValue);return r},u=function(t){var e,n,i,r={trkpt:[]},o=t.childNodes;for(e=0,n=o.length;n>e;++e)i=o[e].tagName,i==MapsGPX.ELEMENTS.TRKPT?r[MapsGPX.ELEMENTS.TRKPT].push(l(o[e])):i!=MapsGPX.ELEMENTS.EXTENSIONS&&o[e].firstChild&&(r[i]=o[e].firstChild.nodeValue);return r},c=function(t){var e,n,i,r={trkseg:[]},o=t.childNodes;for(e=0,n=o.length;n>e;++e)i=o[e].tagName,i==MapsGPX.ELEMENTS.TRKSEG?r[MapsGPX.ELEMENTS.TRKSEG].push(u(o[e])):i!=MapsGPX.ELEMENTS.EXTENSIONS&&o[e].firstChild&&(r[i]=o[e].firstChild.nodeValue);return r},p=function(t){var e,n,i,r,o={metadata:{},wpt:[],rte:[],trk:[]};if(MapsGPX.strict){if(o.version=t.getAttribute("version"),o.creator=t.getAttribute("creator"),"1.1"!=o.version)throw new Error("GPX document is formatted as unsupported version, it requires 1.1 only.");if(!o.creator)throw new Error('Element "gpx" does not have attribute "creator" that is required.')}for(e=t.childNodes,n=0,i=e.length;i>n;++n)r=e[n].tagName,r==MapsGPX.ELEMENTS.WPT?o[MapsGPX.ELEMENTS.WPT].push(l(e[n])):r==MapsGPX.ELEMENTS.RTE?o[MapsGPX.ELEMENTS.RTE].push(h(e[n])):r==MapsGPX.ELEMENTS.TRK?o[MapsGPX.ELEMENTS.TRK].push(c(e[n])):r!=MapsGPX.ELEMENTS.EXTENSIONS&&r!=MapsGPX.ELEMENTS.METADATA&&e[n].firstChild&&(o[r]=e[n].firstChild.nodeValue);return o};for(o=p(t.getElementsByTagName(MapsGPX.ELEMENTS.GPX)[0]),a=MapsGPX.boundsOf(o.wpt,a),e=0,n=o.rte.length;n>e;++e)a=MapsGPX.boundsOf(o.rte[e].rtept,a);for(e=0,n=o.trk.length;n>e;++e)for(i=0,r=o.trk[e].trkseg.length;r>i;++i)a=MapsGPX.boundsOf(o.trk[e].trkseg[i].trkpt,a);return o.metadata[MapsGPX.ELEMENTS.BOUNDS]=a,o},MapsGPX.boundsOf=function(t,e){var n,i;for(e=e||{minlat:90,maxlat:-90,minlon:180,maxlon:-180},n=0,i=t.length;i>n;++n)t[n].lat<e.minlat&&(e.minlat=t[n].lat),e.maxlat<t[n].lat&&(e.maxlat=t[n].lat),t[n].lon<e.minlon&&(e.minlon=t[n].lon),e.maxlon<t[n].lon&&(e.maxlon=t[n].lon);return e},MapsGPX.LatLngBounds=function(t,e){this["super"]=google.maps.LatLngBounds.prototype,this.object_id="MapsGPX.LatLngBounds#"+MapsGPX.LatLngBounds.nextval(),google.maps.LatLngBounds.apply(this,arguments)},MapsGPX.LatLngBounds._sequence=0,MapsGPX.LatLngBounds.nextval=function(){return++MapsGPX.LatLngBounds._sequence},MapsGPX.LatLngBounds.prototype=Object.create(google.maps.LatLngBounds.prototype,{constructor:{value:MapsGPX.LatLngBounds}}),MapsGPX.LatLngBounds.prototype.clone=function(){return new MapsGPX.LatLngBounds(this.getSouthWest(),this.getNorthEast())},MapsGPX.Marker=function(t,e,n){var i=e,r=n||{};this["super"]=google.maps.Marker.prototype,this._element=t,this._source=e,this._overlayed=null,this.object_id="MapsGPX.Marker#"+MapsGPX.Marker.nextval(),r.position=new google.maps.LatLng(i.lat,i.lon),google.maps.Marker.apply(this,[r])},MapsGPX.Marker._sequence=0,MapsGPX.Marker.nextval=function(){return++MapsGPX.Marker._sequence},MapsGPX.Marker.prototype=Object.create(google.maps.Marker.prototype,{constructor:{value:MapsGPX.Marker}}),MapsGPX.Marker.prototype.overlayed=function(){return this._overlayed},MapsGPX.Marker.prototype.isWpt=function(){return this._element==MapsGPX.ELEMENTS.WPT?!0:!1},MapsGPX.Marker.prototype.isRte=function(){return this._element==MapsGPX.ELEMENTS.RTE?!0:!1},MapsGPX.Marker.prototype.isTrk=function(){return this._element==MapsGPX.ELEMENTS.TRK?!0:!1},MapsGPX.Marker.prototype.getSource=function(){return this._source},MapsGPX.Marker.prototype.setMap=function(t){this._overlayed=t?!0:!1,this["super"].setMap.call(this,t)},MapsGPX.Polyline=function(t,e,n){var i,r,o,a=e,s=n||{};for(this["super"]=google.maps.Polyline.prototype,this._element=t,this._source=e,this._overlayed=null,this.object_id="MapsGPX.Polyline#"+MapsGPX.Polyline.nextval(),s.path=new google.maps.MVCArray,i=0,r=0,o=a.length;o>r;++r)s.path.insertAt(i++,new google.maps.LatLng(a[r].lat,a[r].lon));google.maps.Polyline.apply(this,[s])},MapsGPX.Polyline._sequence=0,MapsGPX.Polyline.nextval=function(){return++MapsGPX.Polyline._sequence},MapsGPX.Polyline.prototype=Object.create(google.maps.Polyline.prototype,{constructor:{value:MapsGPX.Polyline}}),MapsGPX.Polyline.prototype.overlayed=function(){return this._overlayed},MapsGPX.Polyline.prototype.isWpt=function(){return this._element==MapsGPX.ELEMENTS.WPT?!0:!1},MapsGPX.Polyline.prototype.isRte=function(){return this._element==MapsGPX.ELEMENTS.RTE?!0:!1},MapsGPX.Polyline.prototype.isTrk=function(){return this._element==MapsGPX.ELEMENTS.TRK?!0:!1},MapsGPX.Polyline.prototype.getSource=function(){return this._source},MapsGPX.Polyline.prototype.setMap=function(t){this._overlayed=t?!0:!1,this["super"].setMap.call(this,t)},MapsGPX.Polyline.prototype.computeDistanceLinear=function(t,e){var n=this.getSource();return google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(n[parseInt(t)].lat,n[parseInt(t)].lon),new google.maps.LatLng(n[parseInt(e)].lat,n[parseInt(e)].lon))},MapsGPX.Polyline.prototype.computeDistanceTrack=function(t,e){var n,i,r,o=this.getSource(),a=0;if(t=parseInt(t),e=parseInt(e),e>=t)for(n=t,i=e;i>n;++n)r=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(o[n].lat,o[n].lon),new google.maps.LatLng(o[n+1].lat,o[n+1].lon)),a=parseFloat(a)+parseFloat(r);else for(n=t,i=e;n>i;--n)r=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(o[n].lat,o[n].lon),new google.maps.LatLng(o[n-1].lat,o[n-1].lon)),a=parseFloat(a)-parseFloat(r);return a},MapsGPX.createLatlngbounds=function(t){return new MapsGPX.LatLngBounds(new google.maps.LatLng(t.minlat,t.minlon),new google.maps.LatLng(t.maxlat,t.maxlon))},MapsGPX.createOverlayAsWpt=function(t,e){if(t instanceof Array)throw new Error("overlay for wpt is not created from Array");return new MapsGPX.Marker(MapsGPX.ELEMENTS.WPT,t,e)},MapsGPX.createOverlayAsRte=function(t,e){return t instanceof Array?new MapsGPX.Polyline(MapsGPX.ELEMENTS.RTE,t,e):new MapsGPX.Marker(MapsGPX.ELEMENTS.RTE,t,e)},MapsGPX.createOverlayAsTrk=function(t,e){return t instanceof Array?new MapsGPX.Polyline(MapsGPX.ELEMENTS.TRK,t,e):new MapsGPX.Marker(MapsGPX.ELEMENTS.TRK,t,e)},MapsGPX.InputHandler=function(){this.initialize.apply(this,arguments)},MapsGPX.InputHandler.prototype.initialize=function(t,e){this.type=t,this.handler=e},MapsGPX.InputHandler.prototype.setType=function(t){return this.type=t,this},MapsGPX.InputHandler.prototype.getType=function(){return this.type},MapsGPX.InputHandler.prototype.setHandler=function(t){return this.handler=t,this},MapsGPX.InputHandler.prototype.getHandler=function(){return this.handler},MapsGPX.InputHandler.defaultHandler=function(t,e){return Promise.resolve(function(e){return t})},MapsGPX.InputHandler.prototype.execute=function(t,e,n){return(this.getHandler()||MapsGPX.InputHandler.defaultHandler).call(t,e,n)},MapsGPX.defaultInputHandlerApplicationGPX=function(t,e){return MapsGPX.resolveAsText(e).then(function(e){return this.addGPX(t,e),t}.bind(this))},MapsGPX.MapControl=function(){this.initialize.apply(this,arguments)},MapsGPX.MapControl.prototype={initialize:function(t,e){var n,i={map:null,initial:Object.keys(t)[0],iconWidth:"28",iconHeight:"28",className:"map_control_button",position:"RIGHT_BOTTOM"};this.icons=t,this.settings={};for(n in i)this.settings[n]=i[n];for(n in e||{})this.settings[n]=e[n];this.map=this.settings.map,this.current_key=this.settings.initial,this.$element=this._createElement(),this.map&&this.setMap(this.map)},getElement:function(){return this.$element},isCurrentIcon:function(t){return this.current_key==t},_getIconByKey:function(t){return this.icons[t]},_getCurrentIcon:function(){return this._getIconByKey(this.current_key)},_getIconElement:function(){return this.$element.getElementsByTagName("img").item(0)},_createElement:function(){var t,e,n,i;t=document.createElement("img"),t.setAttribute("src",this._getCurrentIcon()),t.setAttribute("width",this.settings.iconWidth),t.setAttribute("height",this.settings.iconHeight),e=document.createElement("div"),e.setAttribute("class",this.settings.className),e.style.background="#fff","TOP_LEFT"==this.settings.position?(e.style.marginTop="16px",e.style.marginLeft="4px"):"RIGHT_BOTTOM"==this.settings.position?(e.style.marginBottom="8px",e.style.marginRight="8px"):e.style.margin="8px",e.style.border="1px solid transparent",e.style.borderRadius="2px",e.style.outline="none",e.style.boxShadow="0 2px 6px rgba(0, 0, 0, 0.3)",n=["webkitB","mozB","oB","msB","b"];for(var r in n)e.style[n[r]+"oxSizing"]="border-box";return i=document.createElement("a"),i.setAttribute("href","javascript:void(0)"),i.style.display="block",e.appendChild(t),i.appendChild(e),i},getMap:function(){return this.map},setMap:function(t){this.map=t,this.getMap().controls[google.maps.ControlPosition[this.settings.position]].push(this.$element)},changeIcon:function(t){return this._getIconElement().src=this._getIconByKey(t),this.current_key=t,this}},MapsGPX.prototype.initialize=function(t,e,n){var i;if(this.map=null,this.map_id=t,this.map_options=e||{},this.map_element=document.getElementById(this.map_id),!this.map_element)throw new Error("Could not get element by #"+t);this.object_id="MapsGPX#"+MapsGPX.nextval(),this.map_settings={},this.map_defaults={zoom:5,keyboardShortcuts:!1,center:new google.maps.LatLng(35.6841306,139.774103),mapTypeId:google.maps.MapTypeId.ROADMAP};for(i in this.map_defaults)this.map_settings[i]=this.map_defaults[i];for(i in this.map_options)this.map_settings[i]=this.map_options[i];this.data={},this.context={},this.hook={onShowMarker:[],onShowPolyline:[],onHideMarker:[],onHidePolyline:[],onCreateLatlngbounds:[],onCreateMarker:[],onCreatePolyline:[],onAddGPX:[]},this.filters={onAppearOverlayShow:[],onAppearOverlayHide:[]},this.input_handler={},this.extentions=[],this._afterInitialize()},MapsGPX.prototype._afterInitialize=function(){this.map=new google.maps.Map(this.map_element,this.map_settings),this.registerInputHandler(new MapsGPX.InputHandler("application/gpx",MapsGPX.defaultInputHandlerApplicationGPX)),this.use("SetTitleOnCreateMarker"),this.use("SetStrokeOptionOnCreatePolyline")},MapsGPX.prototype.getMap=function(){return this.map},MapsGPX.prototype.getMapElement=function(){return this.map_element},MapsGPX.prototype.getMapSettings=function(){return this.map_settings},MapsGPX.prototype._bounds_of=function(){var t,e,n,i=[];if(i=0<arguments.length?Array.prototype.slice.call(arguments):this.getKeysOfGPX(),0<i.length){for(t=this.getGPX(i[0]).metadata.latlngbounds.clone(),e=1,n=i.length;n>e;++e)t.union(this.getGPX(i[e]).metadata.latlngbounds);return t}return null},MapsGPX.prototype.fitBounds=function(){var t=this._bounds_of.apply(this,arguments);return t&&this.getMap().fitBounds(t),this},MapsGPX.prototype.panToBounds=function(){var t=this._bounds_of.apply(this,arguments);return t&&this.getMap().panToBounds(t),this},MapsGPX.prototype._applyAppearOverlay=function(t,e,n){var i,r;i=function(t,e){t.setMap(this.getMap()),t.constructor===MapsGPX.Marker?this.applyHook("onShowMarker",t,e):t.constructor===MapsGPX.Polyline&&this.applyHook("onShowPolyline",t,e)},r=function(t,e){t.setMap(null),t.constructor===MapsGPX.Marker?this.applyHook("onShowMarker",t,e):t.constructor===MapsGPX.Polyline&&this.applyHook("onShowPolyline",t,e)},e?this.isFilterEffective("onAppearOverlayShow",t,n)?r.call(this,t,n):i.call(this,t,n):this.isFilterEffective("onAppearOverlayHide",t,n)?i.call(this,t,n):r.call(this,t,n)},MapsGPX.prototype._appearOverlay=function(t,e,n){var i,r,o,a,s,l,h,u=n.length;for(1>u&&(n=this.getKeysOfGPX(),u=n.length),i=0;u>i;++i)for(h=this.data[n[i]][e],r=0,o=h.length;o>r;++r){h[r].overlay&&this._applyAppearOverlay(h[r].overlay,t,n[i]);for(a in h[r])if(h[r][a]instanceof Array)for(s=0,l=h[r][a].length;l>s;++s)h[r][a][s].overlay&&this._applyAppearOverlay(h[r][a][s].overlay,t,n[i])}return this},MapsGPX.prototype.showOverlayWpts=function(){return this._appearOverlay.call(this,!0,MapsGPX.ELEMENTS.WPT,arguments)},MapsGPX.prototype.hideOverlayWpts=function(){return this._appearOverlay.call(this,!1,MapsGPX.ELEMENTS.WPT,arguments)},MapsGPX.prototype.showOverlayRtes=function(){return this._appearOverlay.call(this,!0,MapsGPX.ELEMENTS.RTE,arguments)},MapsGPX.prototype.hideOverlayRtes=function(){return this._appearOverlay.call(this,!1,MapsGPX.ELEMENTS.RTE,arguments)},MapsGPX.prototype.showOverlayTrks=function(){return this._appearOverlay.call(this,!0,MapsGPX.ELEMENTS.TRK,arguments)},MapsGPX.prototype.hideOverlayTrks=function(){return this._appearOverlay.call(this,!1,MapsGPX.ELEMENTS.TRK,arguments)},MapsGPX.prototype.showOverlayGpxs=function(){this.showOverlayWpts.apply(this,arguments),this.showOverlayRtes.apply(this,arguments),this.showOverlayTrks.apply(this,arguments)},MapsGPX.prototype.hideOverlayGpxs=function(){this.hideOverlayWpts.apply(this,arguments),this.hideOverlayRtes.apply(this,arguments),this.hideOverlayTrks.apply(this,arguments)},MapsGPX._guessType=function(t){if("string"==typeof t){if(new RegExp(".jpe?g$","i").test(t))return"image/jpeg"}else if(t instanceof Blob&&"image/jpeg"==t.type)return"image/jpeg";return"application/gpx"},MapsGPX.prototype.registerInputHandler=function(t){if(!(t instanceof MapsGPX.InputHandler))throw new Error("invalid argument, it requires instance of MapsGPX.InputHandler");return this.input_handler[t.type]=t,this},MapsGPX.prototype._getInputHandlerByType=function(t){var e=this.input_handler[t];return e?e:null},MapsGPX.prototype.input=function(t,e,n){var i;return n=n||MapsGPX._guessType(e),i=this._getInputHandlerByType(n),i?i.execute(this,t,e):(console.log("There is no handler for type=["+n+"]"),(new MapsGPX.InputHandler).execute(this,t,e))},MapsGPX.prototype.getGPX=function(t){return this.data[t]},MapsGPX.prototype.eachGPX=function(t){var e;for(e in this.data)t(this.data[e],e);return this},MapsGPX.prototype.getKeysOfGPX=function(){return Object.keys(this.data)},MapsGPX.prototype.addGPX=function(t,e){this.removeGPX(t);try{this.data[t]=this._build(e),this.applyHook("onAddGPX",t,e)}catch(n){throw new Error("Catch an exception at addGPX with "+t+", reason: "+n)}return this},MapsGPX.prototype.removeGPX=function(t){return this.data[t]&&(this.hideOverlayWpts(t),this.hideOverlayRtes(t),this.hideOverlayTrks(t)),this.data[t]=null,delete this.data[t],this},MapsGPX.prototype._build=function(t){var e,n,i,r,o,a=MapsGPX.GPXToJSON(MapsGPX.parseXML(t));for(a.metadata.latlngbounds=MapsGPX.createLatlngbounds(a.metadata.bounds),this.applyHook("onCreateLatlngbounds",a.metadata.latlngbounds),e=0,i=a.wpt.length;i>e;++e)a.wpt[e].overlay=MapsGPX.createOverlayAsWpt(a.wpt[e]),this.applyHook("onCreateMarker",a.wpt[e].overlay);for(e=0,i=a.rte.length;i>e;++e)for(a.rte[e].overlay=MapsGPX.createOverlayAsRte(a.rte[e].rtept),this.applyHook("onCreatePolyline",a.rte[e].overlay),n=0,r=a.rte[e].rtept.length;r>n;++n)a.rte[e].rtept[n].overlay=MapsGPX.createOverlayAsRte(a.rte[e].rtept[n]),this.applyHook("onCreateMarker",a.rte[e].rtept[n].overlay);if(MapsGPX.join_trkseg)for(e=0,i=a.trk.length;i>e;++e){for(o=[],n=0,r=a.trk[e].trkseg.length;r>n;++n)o=o.concat(a.trk[e].trkseg[n].trkpt);a.trk[e].overlay=MapsGPX.createOverlayAsTrk(o),this.applyHook("onCreatePolyline",a.trk[e].overlay)}else for(e=0,i=a.trk.length;i>e;++e)for(n=0,r=a.trk[e].trkseg.length;r>n;++n)a.trk[e].trkseg[n].overlay=MapsGPX.createOverlayAsTrk(a.trk[e].trkseg[n].trkpt),this.applyHook("onCreatePolyline",a.trk[e].trkseg[n].overlay);return a},MapsGPX.prototype.use=function(t,e){MapsGPX.plugin[t].path||(MapsGPX.plugin[t].path=[MapsGPX.plugin_dir,t].join("/"));try{MapsGPX.plugin[t].callback.bind(this)(e)}catch(n){console.error('Catch an exception on use "'+t+'": '+n),console.trace()}return this},MapsGPX.prototype.extend=function(t,e){return this.extentions.push({plugin_name:t,params:e||{}}),this},MapsGPX.prototype.extended=function(t){var e,n,i=[];for(e=0,n=this.extentions.length;n>e;++e)i.push(this.extentions[e].plugin_name);return MapsGPX.require_plugins.apply(this,i).then(function(){var t,e;for(t=0,e=this.extentions.length;e>t;++t)this.use(this.extentions[t].plugin_name,this.extentions[t].params);this.extentions=[]}.bind(this)).then(t.bind(this)),this},MapsGPX.prototype.register=function(t,e){try{this._registerHook(t,e)}catch(n){throw console.log("Catch an exception on register("+t+")"),console.trace(),n}return this},MapsGPX.prototype._registerHook=function(t,e){t?this.hook[t].push(e.bind(this)):e.bind(this)()},MapsGPX.prototype.applyHook=function(){var t,e,n=arguments[0],i=Array.prototype.slice.call(arguments,1);for(t=0,e=this.hook[n].length;e>t;++t)try{this.hook[n][t].apply(this,i)}catch(r){throw console.log('Catch an exception on applyHook "'+n+'" with args ['+i+"]"),console.trace(),r}return this},MapsGPX.prototype.addFilter=function(t,e,n){return this.filters[e][t]=n,this},MapsGPX.prototype.removeFilter=function(t,e){return delete this.filters[e][t],this},MapsGPX.prototype.isFilterEffective=function(){var t,e,n=null,i=Array.prototype.slice.call(arguments),r=i.shift();for(t in this.filters[r]){e=!1;try{e="function"==typeof this.filters[r][t]?this.filters[r][t].apply(this,i):this.filters[r][t]?!0:!1}catch(o){console.log('Catch an exception on isFilterEffective("'+r+'") on "'+t+'": '+o)}if(e){n=!0;break}}return n},MapsGPX.plugin={},MapsGPX.plugin.SetTitleOnCreateMarker={callback:function(t){this.register("onCreateMarker",function(t){t.setTitle(t.getSource().name)}.bind(this))}},MapsGPX.plugin.SetStrokeOptionOnCreatePolyline={callback:function(t){this.register("onCreatePolyline",function(t){t.isRte()?t.setOptions({strokeColor:"#00FF66",strokeOpacity:.75,strokeWeight:2}):t.isTrk()&&t.setOptions({strokeColor:"#0066FF",strokeOpacity:.5,strokeWeight:4})}.bind(this))}},MapsGPX.load_script=function(t){return new Promise(function(e,n){var i=document.createElement("script");i.onload=function(){e()},i.src=t,document.head.appendChild(i)})},MapsGPX.load_css=function(t){return new Promise(function(e,n){var i=document.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",t),i.onload=function(){e()},document.head.appendChild(i)})},MapsGPX.require_plugin=function(t){var e,n=(new Date).getTime(),i=[MapsGPX.plugin_dir,t].join("/"),r={plugin_name:t,base:i,t:n};return e=MapsGPX.cache_script?[i,MapsGPX.scrip_loader].join("/"):[i,MapsGPX.scrip_loader+"?t="+n].join("/"),MapsGPX.load_script(e).then(function(){var t,e,n,i,r=[];for(MapsGPX.plugin[this.plugin_name].path=this.base,t=MapsGPX.plugin[this.plugin_name].bundles||[],n=0,i=t.length;i>n;++n)e=t[n].match(/\//)?t[n]:MapsGPX.cache_script?[this.base,t[n]].join("/"):[this.base,t[n]+"?t="+this.t].join("/"),t[n].match(/\.css$/)?r.push(MapsGPX.load_css(e)):r.push(MapsGPX.load_script(e));return Promise.all(r)}.bind(r))},MapsGPX.require_plugins=function(){var t,e,n=Array.prototype.map.call(arguments,function(t){return t}),i=Promise.resolve(null);for(t=0,e=n.length;e>t;++t)i=i.then(function(){return MapsGPX.require_plugin(this.plugin_name)}.bind({plugin_name:n[t]}));return i},MapsGPX._ready=!1,MapsGPX._on_readies=[],MapsGPX.onReady=function(t){MapsGPX._on_readies.push(t),MapsGPX._ready&&MapsGPX._emit()},MapsGPX._emit=function(){for(var t;;){if(t=MapsGPX._on_readies.shift(),!t)break;t.call(this)}return this},function(){google.maps.event.addDomListener(window,"load",function(){MapsGPX._ready=!0,MapsGPX._emit()})}(),MapsGPX.plugin.DescImage={callback:function(t){this.register("onCreateMarker",function(t){var e=t.getSource().desc;(!new RegExp("[\r\n]").test(e)&&new RegExp(".jpe?g$","i").test(e)||new RegExp("^data:image/jpeg;base64,[+/=0-9A-Za-z\r\n]+$").test(e)||new RegExp("^blob:(https?(:|%3A)//[-_.(:|%3A)0-9A-Za-z]+?|file(:|%3A)//)/[-0-9A-Za-z]+$").test(e)||new RegExp("^blob:null/[-0-9A-Za-z]+$").test(e))&&(google.maps.event.addListener(t,"click",function(t){
this._infowindow||(this._infowindow=new google.maps.InfoWindow({content:['<div><a href="',e,'" target="preview"><img class="info-window" src="',e,'"/></div>'].join("")})),this._infowindow.open(this.getMap(),this)}),t.setIcon(new google.maps.MarkerImage([MapsGPX.plugin.DescImage.path,"photo.png"].join("/"),new google.maps.Size(32,37))))}.bind(this))}},MapsGPX.plugin.DrawerCSS={bundles:["drawer-css.js"],callback:function(t){}},DrawerCSS.VERSION="0.4.0",DrawerCSS._vendorT=["webkitT","mozT","oT","msT","t"],DrawerCSS.getDimensions=function(t){var e=t.style.display;if("none"!=e&&null!=e)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.style,i=n.visibility,r=n.position,o=n.display,a=t.clientWidth;t.clientHeight;return n.visibility="hidden",n.position="absolute",n.display="block",n.display=o,n.position=r,n.visibility=i,{width:a,height:t.originalHeight}},DrawerCSS.defaults={duration:.3,delay:0,timingFunction:"ease-in-out",effect:"slide",side:"LEFT",span:"80%",maxSpan:null},DrawerCSS.prototype={initialize:function(t,e,n){var i;n=n||{},this.settings={};for(i in DrawerCSS.defaults)this.settings[i]=DrawerCSS.defaults[i];for(i in n)this.settings[i]=n[i];this.duration=parseFloat(this.settings.duration).toString(),this.delay=parseFloat(this.settings.delay).toString(),this.timingFunction=this.settings.timingFunction.toLowerCase(),this.effect=this.settings.effect.toLowerCase(),this.side=this.settings.side.toUpperCase(),this.span=this.settings.span,this.maxSpan=this.settings.maxSpan,this.span.toString().match(/\d+$/)&&(this.span=this.span+"px"),this.maxSpan&&this.maxSpan.toString().match(/\d+$/)&&(this.maxSpan=this.maxSpan+"px"),this._opened=!1,this._events={},this._origin={},this.$main=document.getElementById(t),this.$sub=document.getElementById(e),this.$sub||(this.$sub=document.createElement("div"),this.$sub.setAttribute("id",e)),this.reset()},active_span:function(){var t=this.span;return"function"==typeof this.span&&(t=this.span.call(this)),this.maxSpan&&(t.toString().match(/%$/)?t=this._span_limited_by_percent():t.toString().match(/\d+\s*px$/)&&(t=this._span_limited_by_pixel())),t},_span_limited_by_percent:function(){var t,e={LEFT:"width",TOP:"height",RIGHT:"width",BOTTOM:"height"}[this.side],n=DrawerCSS.getDimensions(this.getElementBase())[e];return this.maxSpan.toString().match(/px$/)?(t=parseInt(n*parseInt(this.span)/100),parseInt(this.maxSpan)<t&&(t=parseInt(this.maxSpan)),t+="px",this.getElementDrawer().style[e]=t,t):(console.error('the option "maxSpan" has to be specified as "px"'),this.span)},_span_limited_by_pixel:function(){var t,e,n={LEFT:"width",TOP:"height",RIGHT:"width",BOTTOM:"height"}[this.side],i=DrawerCSS.getDimensions(this.getElementBase())[n];return this.maxSpan.toString().match(/%$/)?(t=parseInt(this.span),e=parseInt(i*parseInt(this.maxSpan)/100),t>e&&(t=e),t+="px",this.getElementDrawer().style[n]=t,t):(console.error('the option "maxSpan" has to be specified as "%"'),this.span)},reset:function(){this.destroy(),this.$main.parentNode.style.position="relative",this.$main.style.width="100%",this.$main.style.height="100%",this[{slide:"_init_slide",compress:"_init_compress"}[this.effect]].call(this),this.$main.style.position="absolute",this.$sub.style.position="absolute",this.$main.parentNode.insertBefore(this.$sub,this.$main)},destroy:function(){var t;for(t in DrawerCSS._vendorT)this.$main.style[DrawerCSS._vendorT[t]+"ransitionProperty"]="",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDuration"]="",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDelay"]="",this.$main.style[DrawerCSS._vendorT[t]+"ransitionTimingFunction"]="";this.$main.parentNode.style.position="",this.$main.style.position="",this.$main.style.width="",this.$main.style.height="",this.$main.style.top="",this.$main.style.right="",this.$main.style.bottom="",this.$main.style.left="",this.$sub.style.position="",this.$sub.style.width="",this.$sub.style.height="",this.$sub.style.top="",this.$sub.style.right="",this.$sub.style.bottom="",this.$sub.style.left=""},_init_slide:function(){var t;for(t in DrawerCSS._vendorT)this.$main.style[DrawerCSS._vendorT[t]+"ransitionProperty"]="top,right,bottom,left",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDuration"]=this.duration+"s",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDelay"]=this.delay+"s",this.$main.style[DrawerCSS._vendorT[t]+"ransitionTimingFunction"]=this.timingFunction;if("TOP"==this.side)this.$main.style.bottom||(this.$main.style.bottom=0),this._origin={attribute:"bottom",value:this.$main.style.bottom},this.$sub.style.width="100%",this.$sub.style.height=this.active_span(),this.$sub.style.top=0,this.$sub.style.right="",this.$sub.style.bottom="",this.$sub.style.left=0;else if("RIGHT"==this.side)this.$main.style.left||(this.$main.style.left=0),this._origin={attribute:"left",value:this.$main.style.left},this.$sub.style.width=this.active_span(),this.$sub.style.height="100%",this.$sub.style.top=0,this.$sub.style.right=0,this.$sub.style.bottom="",this.$sub.style.left="";else if("BOTTOM"==this.side)this.$main.style.top||(this.$main.style.top=0),this._origin={attribute:"top",value:this.$main.style.top},this.$sub.style.width="100%",this.$sub.style.height=this.active_span(),this.$sub.style.top="",this.$sub.style.right=0,this.$sub.style.bottom=0,this.$sub.style.left="";else{if("LEFT"!=this.side)throw new Error("The property 'side' is invalid value");this.$main.style.right||(this.$main.style.right=0),this._origin={attribute:"right",value:this.$main.style.right},this.$sub.style.width=this.active_span(),this.$sub.style.height="100%",this.$sub.style.top=0,this.$sub.style.right="",this.$sub.style.bottom="",this.$sub.style.left=0}},_init_compress:function(){var t;for(t in DrawerCSS._vendorT)this.$main.style[DrawerCSS._vendorT[t]+"ransitionProperty"]="width,height",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDuration"]=this.duration+"s",this.$main.style[DrawerCSS._vendorT[t]+"ransitionDelay"]=this.delay+"s",this.$main.style[DrawerCSS._vendorT[t]+"ransitionTimingFunction"]=this.timingFunction;if("TOP"==this.side)this.$main.style.bottom=0,this.$sub.style.width="100%",this.$sub.style.height=this.active_span(),this.$sub.style.top=0,this.$sub.style.left=0;else if("RIGHT"==this.side)this.$main.style.left=0,this.$sub.style.width=this.active_span(),this.$sub.style.height="100%",this.$sub.style.bottom=0,this.$sub.style.right=0;else if("BOTTOM"==this.side)this.$main.style.top=0,this.$sub.style.width="100%",this.$sub.style.height=this.active_span(),this.$sub.style.bottom=0,this.$sub.style.right=0;else{if("LEFT"!=this.side)throw new Error("A property 'side' is invalid value");this.$main.style.right=0,this.$sub.style.width=this.active_span(),this.$sub.style.height="100%",this.$sub.style.top=0,this.$sub.style.left=0}},getElementBase:function(){return this.$main},getElementDrawer:function(){return this.$sub},isOpened:function(){return this._opened},open:function(){if(this._opened=!0,this[{slide:"_open_slide",compress:"_open_compress"}[this.effect]].call(this),this._events.open)try{for(var t=0,e=this._events.open.length;e>t;++t)this._events.open[t].call(this)}catch(n){console.error(n)}return this},_open_slide:function(){this.$main.style[{LEFT:"right",TOP:"bottom",RIGHT:"left",BOTTOM:"top"}[this.side]]="-"+this.active_span()},_open_compress:function(){"LEFT"==this.side?(this.$sub.style.width=this.active_span(),this.$main.style.width=DrawerCSS.getDimensions(this.$main).width-DrawerCSS.getDimensions(this.$sub).width+"px"):"BOTTOM"==this.side?(this.$sub.style.height=this.active_span(),this.$main.style.height=DrawerCSS.getDimensions(this.$main).height-DrawerCSS.getDimensions(this.$sub).height+"px"):"TOP"==this.side?(this.$sub.style.height=this.active_span(),this.$main.style.height=DrawerCSS.getDimensions(this.$main).height-DrawerCSS.getDimensions(this.$sub).height+"px"):"RIGHT"==this.side&&(this.$sub.style.width=this.active_span(),this.$main.style.width=DrawerCSS.getDimensions(this.$main).width-DrawerCSS.getDimensions(this.$sub).width+"px")},close:function(){if(this._opened=!1,this[{slide:"_close_slide",compress:"_close_compress"}[this.effect]].call(this),this._events.close)try{for(var t=0,e=this._events.close.length;e>t;++t)this._events.close[t].call(this)}catch(n){console.error(n)}return this},_close_slide:function(){this.$main.style[this._origin.attribute]=this._origin.value},_close_compress:function(){this.$main.style[{TOP:"height",RIGHT:"width",BOTTOM:"height",LEFT:"width"}[this.side]]=""},toggle:function(){return this.isOpened()?(this.close(),!1):(this.open(),!0)},addHandler:function(t,e){return this._events[t]||(this._events[t]=[]),this._events[t].push(e),this}},MapsGPX.plugin.Droppable={callback:function(t){var e=document.getElementById(this.map_id);google.maps.event.addDomListener(e,"dragover",function(t){t.stopPropagation(),t.preventDefault()}.bind(this)),google.maps.event.addDomListener(e,"drop",function(t){var e,n,i,r;for(t.stopPropagation(),t.preventDefault(),e=t.dataTransfer.files,i=0,r=e.length;r>i;++i)n=e[i],console.log("Dropped: name=["+n.name+"] type=["+n.type+"] size=["+n.size+"]"),this.input(n.name,n)}.bind(this))}},MapsGPX.plugin.EXIF={bundles:["exif.js"],readFromArrayBuffer:function(t){return EXIF.readFromBinaryFile(t)},createLatlngFromExif:function(t){if(t.GPSLatitude&&t.GPSLongitude){var e=t.GPSLatitude,n=e[0].numerator/e[0].denominator,i=e[1].numerator/e[1].denominator,r=e[2].numerator/e[2].denominator,o=t.GPSLongitude,a=o[0].numerator/o[0].denominator,s=o[1].numerator/o[1].denominator,l=o[2].numerator/o[2].denominator;return new google.maps.LatLng(n+i/60+r/3600,a+s/60+l/3600)}return null},callback:function(t){var e;this.hook.onReadEXIF=this.hook.onReadEXIF||[],console.log("Extends MapsGPX.Polyline.prototype.findNearestVertexByDate"),MapsGPX.Polyline.prototype.findNearestVertexByDate=function(t){var e,n,i=this.getSource(),r=null,o=!1,a=-1;for(e=0,n=i.length;n>e;++e)if(r=new Date(i[e].time),r>=t){t==r&&(o=!0),a=e;break}return a>=1||0==a&&o?{latlng:this.getPath().getAt(a),time:r,index:a}:null},e=function(t,e){var n=MapsGPX.resolveAsArrayBuffer(e),i=MapsGPX.resolveAsObjectURL(e);return Promise.all([n,i,e]).then(function(e){var n,i,r,o,a,s,l,h,u=MapsGPX.plugin.EXIF.readFromArrayBuffer(e[0]),c=MapsGPX.plugin.EXIF.createLatlngFromExif(u),p=[],d=[];if(null==c&&u.DateTimeOriginal&&(n=u.DateTimeOriginal.split(/\s+/),i=new Date(n[0].replace(/:/g,"/")+" "+n[1]),a=function(t,e){var n;return t?(n=t.findNearestVertexByDate(i),n&&(n.key=e,this.push(n)),!0):!1},this.eachGPX(function(t,e){var n,i,r,o;for(n=0,i=t.trk.length;i>n;++n)if(!a.call(this,t.trk[n].overlay,e))for(r=0,o=t.trk[n].trkseg.length;o>r;++r)a.call(this,t.trk[n].trkseg[r].overlay,e)}.bind(p)),0<p.length)){for(s=p.sort(function(t,e){return t.time-e.time}),p=[],p.push(s[0]),l=s[0].time,r=1,o=s.length;o>r&&l.toJSON()==s[r].time.toJSON();++r)p.push(s[r]);c=p[0].latlng,d=p}if(h={exif:u,url:e[1],src:e[2],gpx:null,latlng:c,alternatives:d},!c)throw new Error('Could not detect coordinate of the image "'+t+'"');return 0!=this.hook.onReadEXIF.length?this.applyHook("onReadEXIF",t,h):MapsGPX.plugin.EXIF._handlerHookOnReadExifDefault.call(this,t,h),t}.bind(this))},console.log('Register an input handler for "image/jpeg"'),this.registerInputHandler(new MapsGPX.InputHandler("image/jpeg",e))},_handlerHookOnReadExifDefault:function(t,e){var n,i,r,o=null;if(e.alternatives.length<=1)o=e.latlng;else for(n=0,i=e.alternatives.length;i>n;++n)if(window.confirm('Are you sure the image is on "'+e.alternatives[n].key+'" ?')){o=e.alternatives[n].latlng;break}o?(r=[e.exif.DateTimeOriginal," - ",t,'<br/><img class="info-window" src="',e.url,'"/>'].join(""),this.map.panTo(e.latlng),new google.maps.InfoWindow({content:r,position:o}).open(this.map)):window.alert('Could not detect coordinate of the image "'+t+'"')}},function(){function t(t){return!!t.exifdata}function e(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(t),i=n.length,r=new ArrayBuffer(i),o=new Uint8Array(r),a=0;i>a;a++)o[a]=n.charCodeAt(a);return r}function i(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(t){(200==this.status||0===this.status)&&e(this.response)},n.send()}function r(t,n){function r(e){var i=o(e),r=a(e);t.exifdata=i||{},t.iptcdata=r||{},n&&n.call(t)}if(t.src)if(/^data\:/i.test(t.src)){var s=e(t.src);r(s)}else if(/^blob\:/i.test(t.src)){var l=new FileReader;l.onload=function(t){r(t.target.result)},i(t.src,function(t){l.readAsArrayBuffer(t)})}else{var h=new XMLHttpRequest;h.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";r(h.response),h=null},h.open("GET",t.src,!0),h.responseType="arraybuffer",h.send(null)}else if(window.FileReader&&(t instanceof window.Blob||t instanceof window.File)){var l=new FileReader;l.onload=function(t){p&&console.log("Got file of length "+t.target.result.byteLength),r(t.target.result)},l.readAsArrayBuffer(t)}}function o(t){var e=new DataView(t);if(p&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return p&&console.log("Not a valid JPEG"),!1;for(var n,i=2,r=t.byteLength;r>i;){if(255!=e.getUint8(i))return p&&console.log("Not a valid marker at offset "+i+", found: "+e.getUint8(i)),!1;if(n=e.getUint8(i+1),p&&console.log(n),225==n)return p&&console.log("Found 0xFFE1 marker"),c(e,i+4,e.getUint16(i+2)-2);i+=2+e.getUint16(i+2)}}function a(t){var e=new DataView(t);if(p&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return p&&console.log("Not a valid JPEG"),!1;for(var n=2,i=t.byteLength,r=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};i>n;){if(r(e,n)){var o=e.getUint8(n+7);o%2!==0&&(o+=1),0===o&&(o=4);var a=n+8+o,l=e.getUint16(n+6+o);return s(t,a,l)}n++}}function s(t,e,n){for(var i,r,o,a,s,l=new DataView(t),h={},c=e;e+n>c;)28===l.getUint8(c)&&2===l.getUint8(c+1)&&(a=l.getUint8(c+2),a in v&&(o=l.getInt16(c+3),s=o+5,r=v[a],i=u(l,c+5,o),h.hasOwnProperty(r)?h[r]instanceof Array?h[r].push(i):h[r]=[h[r],i]:h[r]=i)),c++;return h}function l(t,e,n,i,r){var o,a,s,l=t.getUint16(n,!r),u={};for(s=0;l>s;s++)o=n+12*s+2,a=i[t.getUint16(o,!r)],!a&&p&&console.log("Unknown tag: "+t.getUint16(o,!r)),u[a]=h(t,o,e,n,r);return u}function h(t,e,n,i,r){var o,a,s,l,h,c,p=t.getUint16(e+2,!r),d=t.getUint32(e+4,!r),f=t.getUint32(e+8,!r)+n;switch(p){case 1:case 7:if(1==d)return t.getUint8(e+8,!r);for(o=d>4?f:e+8,a=[],l=0;d>l;l++)a[l]=t.getUint8(o+l);return a;case 2:return o=d>4?f:e+8,u(t,o,d-1);case 3:if(1==d)return t.getUint16(e+8,!r);for(o=d>2?f:e+8,a=[],l=0;d>l;l++)a[l]=t.getUint16(o+2*l,!r);return a;case 4:if(1==d)return t.getUint32(e+8,!r);for(a=[],l=0;d>l;l++)a[l]=t.getUint32(f+4*l,!r);return a;case 5:if(1==d)return h=t.getUint32(f,!r),c=t.getUint32(f+4,!r),s=new Number(h/c),s.numerator=h,s.denominator=c,s;for(a=[],l=0;d>l;l++)h=t.getUint32(f+8*l,!r),c=t.getUint32(f+4+8*l,!r),a[l]=new Number(h/c),a[l].numerator=h,a[l].denominator=c;return a;case 9:if(1==d)return t.getInt32(e+8,!r);for(a=[],l=0;d>l;l++)a[l]=t.getInt32(f+4*l,!r);return a;case 10:if(1==d)return t.getInt32(f,!r)/t.getInt32(f+4,!r);for(a=[],l=0;d>l;l++)a[l]=t.getInt32(f+8*l,!r)/t.getInt32(f+4+8*l,!r);return a}}function u(t,e,i){var r="";for(n=e;n<e+i;n++)r+=String.fromCharCode(t.getUint8(n));return r}function c(t,e){if("Exif"!=u(t,e,4))return p&&console.log("Not valid EXIF data! "+u(t,e,4)),!1;var n,i,r,o,a,s=e+6;if(18761==t.getUint16(s))n=!1;else{if(19789!=t.getUint16(s))return p&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(s+2,!n))return p&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var h=t.getUint32(s+4,!n);if(8>h)return p&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(s+4,!n)),!1;if(i=l(t,s,s+h,m,n),i.ExifIFDPointer){o=l(t,s,s+i.ExifIFDPointer,g,n);for(r in o){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":o[r]=_[r][o[r]];break;case"ExifVersion":case"FlashpixVersion":o[r]=String.fromCharCode(o[r][0],o[r][1],o[r][2],o[r][3]);break;case"ComponentsConfiguration":o[r]=_.Components[o[r][0]]+_.Components[o[r][1]]+_.Components[o[r][2]]+_.Components[o[r][3]]}i[r]=o[r]}}if(i.GPSInfoIFDPointer){a=l(t,s,s+i.GPSInfoIFDPointer,y,n);for(r in a){switch(r){case"GPSVersionID":a[r]=a[r][0]+"."+a[r][1]+"."+a[r][2]+"."+a[r][3]}i[r]=a[r]}}return i}var p=!1,d=this,f=function(t){return t instanceof f?t:this instanceof f?void(this.EXIFwrapped=t):new f(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=f),exports.EXIF=f):d.EXIF=f;var g=f.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},m=f.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},y=f.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},_=f.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},v={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};f.getData=function(e,n){return(e instanceof Image||e instanceof HTMLImageElement)&&!e.complete?!1:(t(e)?n&&n.call(e):r(e,n),!0)},f.getTag=function(e,n){return t(e)?e.exifdata[n]:void 0},f.getAllTags=function(e){if(!t(e))return{};var n,i=e.exifdata,r={};for(n in i)i.hasOwnProperty(n)&&(r[n]=i[n]);return r},f.pretty=function(e){if(!t(e))return"";var n,i=e.exifdata,r="";for(n in i)i.hasOwnProperty(n)&&(r+="object"==typeof i[n]?i[n]instanceof Number?n+" : "+i[n]+" ["+i[n].numerator+"/"+i[n].denominator+"]\r\n":n+" : ["+i[n].length+" values]\r\n":n+" : "+i[n]+"\r\n");return r},f.readFromBinaryFile=function(t){return o(t)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return f})}.call(this),MapsGPX.plugin.EXIF2GPX={callback:function(t){this.context.EXIF2GPX={pts:[]},this.register("onReadEXIF",function(t,e){var n,i,r,o,a,s;if(this.context.EXIF2GPX.pts.push({lat:e.latlng.lat(),lon:e.latlng.lng()}),1<this.context.EXIF2GPX.pts.length?(n=MapsGPX.boundsOf(this.context.EXIF2GPX.pts),this.map.fitBounds(MapsGPX.createLatlngbounds(n))):this.map.panTo(e.latlng),i=null,e.alternatives.length<=1)i=e.latlng;else for(r=0,o=e.alternatives.length;o>r;++r)if(window.confirm('Are you sure the image is on "'+e.alternatives[r].key+'" ?')){i=e.alternatives[r].latlng;break}i?(a=e.exif.DateTimeOriginal||"(unknown)",s=['<?xml version="1.0"?>','<gpx version="1.1" creator="maps.gpx" ','xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.topografix.com/GPX/1/1" ','xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">',"<metadata>",a?"<name><![CDATA["+a+"]]></name>":"","</metadata>",'<wpt lat="'+e.latlng.lat()+'" lon="'+e.latlng.lng()+'">',a?"<name><![CDATA["+a+"]]></name>":"","<desc><![CDATA["+e.url+"]]></desc>","</wpt></gpx>"].join(""),this.addGPX(t,s)):window.alert('Could not detect coordinate of the image "'+t+'"')}.bind(this))}},MapsGPX.plugin.EXIFMarker={callback:function(t){this.context.EXIFMarker={pts:[]},this.register("onReadEXIF",function(t,e){var n,i,r,o,a,s;if(this.context.EXIFMarker.pts.push({lat:e.latlng.lat(),lon:e.latlng.lng()}),1<this.context.EXIFMarker.pts.length?(n=MapsGPX.boundsOf(this.context.EXIFMarker.pts),this.map.fitBounds(MapsGPX.createLatlngbounds(n))):this.map.panTo(e.latlng),i=null,e.alternatives.length<=1)i=e.latlng;else for(r=0,o=e.alternatives.length;o>r;++r)if(window.confirm('Are you sure the image is on "'+e.alternatives[r].key+'" ?')){i=e.alternatives[r].latlng;break}i?(a=["<div><strong>",e.exif.DateTimeOriginal," - ",t,"</strong></div><hr/>",'<div><img class="info-window" src="',e.url,'"/></div>'].join(""),s=new google.maps.Marker({position:e.latlng,draggable:!0,icon:new google.maps.MarkerImage([MapsGPX.plugin.EXIFMarker.path,"photo.png"].join("/"),new google.maps.Size(32,37))}),s.addListener("click",function(t){new google.maps.InfoWindow({content:a}).open(this.map,this)}),s.setMap(this.map)):window.alert('Could not detect coordinate of the image "'+t+'"')}.bind(this))}},MapsGPX.plugin.Editor={callback:function(t){this.register("onCreatePolyline",function(t){t.addListener("click",function(t){this.polyline.setEditable(!0)}.bind({app:this,polyline:t})),t.addListener("dblclick",function(t){this.polyline.setEditable(!1)}.bind({app:this,polyline:t}))}.bind(this))}},MapsGPX.plugin.ElevationChart={bundles:["https://www.google.com/jsapi"],templateOfId:"chart_canvas",_sequence:0,generateId:function(){return this.templateOfId+""+ ++this._sequence},callback:function(t){var e=new MapsGPX.MapControl({initial:[MapsGPX.plugin.ElevationChart.path,"ic_trending_up_black_48dp.png"].join("/")},{map:this.getMap()});google.load("visualization","1",{packages:["corechart"],callback:function(){var t,e=this.app,n=this.control,i={effect:"compress",side:"BOTTOM",span:"30%"},r=new DrawerCSS(e.getMapElement().getAttribute("id"),MapsGPX.plugin.ElevationChart.generateId(),i);r.chart=new google.visualization.LineChart(r.getElementDrawer()),r.marker=new google.maps.Marker({icon:new google.maps.MarkerImage([MapsGPX.plugin.ElevationChart.path,"you-are-here-2.png"].join("/"),new google.maps.Size(32,37))}),r.current_polyline=null,google.maps.event.addDomListener(n.getElement(),"click",function(t){this.toggle()}.bind(r)),google.maps.event.addDomListener(window,"resize",function(t){this.close()}.bind(r)),google.visualization.events.addListener(r.chart,"select",function(){var t,e;this.on_select_chart&&(t=this.chart.getSelection(),t&&(e=t[0],e&&this.on_select_chart.call(this,e.row,e.column)))}.bind(r)),e.register("onVertexInfo",function(t,e,n){this.isOpened()&&this.current_polyline===t&&this.chart.setSelection([{row:e,column:1}])}.bind(r)),t=function(t){var e,n,i,r,o,a=[],s=0;if(this.view.isOpened()){if(this.view.current_polyline!==this.polyline){for(e=this.polyline.getSource(),a=[],s=0,a.push(["distance","ele"]),a.push([0,parseInt(e[0].ele)]),n=1,i=e.length;i>n;++n)s+=parseInt(google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e[n-1].lat,e[n-1].lon),new google.maps.LatLng(e[n].lat,e[n].lon))),a.push([s,parseInt(e[n].ele)]);r=google.visualization.arrayToDataTable(a),o={title:e.name||"Elevation chart of the trk",legend:{position:"none"},vAxis:{format:"decimal"},hAxis:{format:"decimal"}},this.view.marker.setMap(null),this.view.chart.draw(r,o),this.view.current_polyline=this.polyline,this.view.on_select_chart=function(t,e){var n=r.getValue(t,e);this.view.marker.setPosition(this.polyline.getPath().getAt(t)),this.view.marker.setTitle("#"+t+" - ele = "+n+"m"),this.view.marker.getMap()||this.view.marker.setMap(this.polyline.getMap())}.bind(this),this.view.addHandler("close",function(){this.current_polyline=null,this.marker.setMap(null),this.chart.clearChart()}.bind(this.view))}}else this.view.current_polyline=null,this.view.marker.setMap(null),this.view.chart.clearChart()},e.register("onCreatePolyline",function(e){google.maps.event.addListener(e,"click",t.bind({view:this,polyline:e}))}.bind(r)),e.eachGPX(function(e,n){var i,r,o,a,s,l=e.trk.length;for(i=0;l>i;++i)if(r=e.trk[i],r.overlay)google.maps.event.addListener(r.overlay,"click",t.bind({view:this,polyline:r.overlay}));else for(o=0,a=r.trkseg.length;a>o;++o)s=r[o],s.overlay&&google.maps.event.addListener(s.overlay,"click",t.bind({view:this,polyline:s.overlay}))}.bind(r))}.bind({app:this,control:e})})}},MapsGPX.plugin.Exporter={bundles:["jszip.js","progressbar.js"],trimDoc:function(t,e){var n,i,r,o,a,s,l=!1;for(n=e.wpt.length-1;n>=0;--n)e.wpt[n].overlay.overlayed()?l=!0:(r=t.getElementsByTagName(MapsGPX.ELEMENTS.WPT)[n],r.parentNode.removeChild(r));for(n=e.rte.length-1;n>=0;--n)e.rte[n].overlay.overlayed()?l=!0:(r=t.getElementsByTagName(MapsGPX.ELEMENTS.RTE)[n],r.parentNode.removeChild(r));for(n=e.trk.length-1;n>=0;--n)if(e.trk[n].overlay)e.trk[n].overlay.overlayed()?l=!0:(r=t.getElementsByTagName(MapsGPX.ELEMENTS.TRK)[n],r.parentNode.removeChild(r));else{for(o=!1,i=e.trk[n].trkseg.length-1;i>=0;--i)e.trk[n].trkseg[i].overlay.overlayed()?o=!0:(r=t.getElementsByTagName(MapsGPX.ELEMENTS.TRK)[n].getElementsByTagName(MapsGPX.ELEMENTS.TRKSEG),r.parentNode.removeChild(r));o?l=!0:(r=t.getElementsByTagName(MapsGPX.ELEMENTS.TRK)[n],r.parentNode.removeChild(r))}return l?(a=function(t){var e,r,o=[];for(e=t.getElementsByTagName(MapsGPX.ELEMENTS.WPT),n=0,i=e.length;i>n;++n)o.push({lat:e[n].getAttribute("lat"),lon:e[n].getAttribute("lon")});for(e=t.getElementsByTagName(MapsGPX.ELEMENTS.RTEPT),n=0,i=e.length;i>n;++n)o.push({lat:e[n].getAttribute("lat"),lon:e[n].getAttribute("lon")});for(e=t.getElementsByTagName(MapsGPX.ELEMENTS.TRKPT),n=0,i=e.length;i>n;++n)o.push({lat:e[n].getAttribute("lat"),lon:e[n].getAttribute("lon")});return e=MapsGPX.boundsOf(o),r=document.createElementNS("http://www.topografix.com/GPX/1/1",MapsGPX.ELEMENTS.BOUNDS),r.setAttribute("minlat",e.minlat),r.setAttribute("minlon",e.minlon),r.setAttribute("maxlat",e.maxlat),r.setAttribute("maxlon",e.maxlon),r}(t),s=function(){var e=t.getElementsByTagName(MapsGPX.ELEMENTS.METADATA);return e.length?e.item(0):document.createElementNS("http://www.topografix.com/GPX/1/1",MapsGPX.ELEMENTS.METADATA)}(),r=s.getElementsByTagName(MapsGPX.ELEMENTS.BOUNDS),r.length?s.replaceChild(a,r.item(0)):s.insertBefore(a,s.getElementsByTagName(MapsGPX.ELEMENTS.EXTENSIONS).item(0)),t):null},mayBeJpegStream:function(t){return!new RegExp("[\r\n]").test(t)&&new RegExp(".jpe?g$","i").test(t)||new RegExp("^data:image/jpeg;base64,[+/=0-9A-Za-z\r\n]+$").test(t)||new RegExp("^blob:(https?(:|%3A)//[-_.(:|%3A)0-9A-Za-z]+?|file(:|%3A)//)/[-0-9A-Za-z]+$").test(t)||new RegExp("^blob:null/[-0-9A-Za-z]+$").test(t)?!0:!1},handler_zip_gpx:function(t,e,n){var i,r,o,a,s,l,h,u,c=new JSZip,p=[];for(h=c.folder(n.folder),s=0,l=t.length;l>s;++s)if(r=MapsGPX.plugin.Exporter.trimDoc(MapsGPX.parseXML(this.context.Exporter.docs[t[s]]),this.getGPX(t[s]))){if(i=!1,u=[],a=t[s],a=new RegExp("([^/]+)$").test(a)?RegExp.$1:"untitled.gpx",new RegExp(".jpe?g$","i").test(a))try{o=r.getElementsByTagName(MapsGPX.ELEMENTS.WPT).item(0).getElementsByTagName(MapsGPX.ELEMENTS.DESC).item(0).textContent,MapsGPX.plugin.Exporter.mayBeJpegStream(o)?i=!0:a+=".gpx"}catch(d){console.warn("It seemed a JPEG but could not take out the content")}i?(u.push(MapsGPX.resolveAsArrayBuffer(o).then(function(t){return t})),u.unshift(a),p.push(Promise.all(u).then(function(t){return[t[0],t[1]]}).then(function(t){this.file(t[0],t[1],{compressionOptions:{level:9},binary:!0})}.bind(h)))):(u.unshift(r),u.unshift(a),p.push(Promise.all(u).then(function(t){return[t[0],t[1]];
}).then(function(t){this.file(t[0],(new XMLSerializer).serializeToString(t[1]),{compressionOptions:{level:9}})}.bind(h))))}return Promise.all(p).then(function(t){return this.params.validator.call(this.app,this.zip),{name:this.params.folder,data:this.zip.generate({type:e,compressionOptions:{level:9}})}}.bind({app:this,zip:h,params:n}))},createControl:function(t){return new MapsGPX.MapControl({initial:new RegExp(t).test("/")?t:[MapsGPX.plugin.Exporter.path,t].join("/")},{position:"TOP_RIGHT"})},extendControl:function(t,e){return e=e||{},t.$icon=t.getElement().getElementsByTagName("img").item(0),t.$container_progress=function(t,e){var n=document.createElement("div");return n.style.width=t+"px",n.style.height=e+"px",n.style.margin=0,n.style.padding=0,n}(t.settings.iconWidth,t.settings.iconHeight),t.$progress=new ProgressBar.Circle(t.$container_progress,{color:e.color||"#333",trailColor:e.trailColor||"#ccc",strokeWidth:e.strokeWidth||5}),t.showProgress=function(){this.$icon.style.display="none",this.$icon.parentNode.appendChild(this.$container_progress)},t.hideProgress=function(){this.$icon.style.display="",this.$icon.parentNode.removeChild(this.$container_progress)},t.inProgress=function(){return""==this.$icon.style.display?!1:!0},t.animate=function(t,e){e=e||{},this.$progress.animate(t,e)},t.animateWithText=function(t,e){this.animate(t,e),this.$progress.setText(parseInt(100*t))},t.setValue=function(t){this.$progress.set(t)},t.setText=function(t){this.$progress.setText(t)},t},exportToDesktop:function(t){var e,n=t.icon||t.iconDownload;e=MapsGPX.plugin.Exporter.extendControl(MapsGPX.plugin.Exporter.createControl(n),{strokeWidth:20}),e.setMap(this.getMap()),MapsGPX.isSafari()?MapsGPX.plugin.Exporter._exportToDesktopSafari.call(this,e,t):MapsGPX.plugin.Exporter._exportToDesktopNotSafari.call(this,e,t)},_exportToDesktopNotSafari:function(t,e){var n=function(t){Promise.all([this,t.name,MapsGPX.resolveAsObjectURL(t.data)]).then(function(t){var e=t[0],n=t[1],i=t[2],r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download",n+".zip"),r.click(),r=null,URL.revokeObjectURL(i),setTimeout(function(){this.control.hideProgress(),this.params.onLoad.call(this,null,this.control)}.bind(e),2e3)})}.bind({control:t,params:e});google.maps.event.addDomListener(t.getElement(),"click",function(t){return this.control.inProgress()?!1:(this.control.showProgress(),this.control.animate(1e3,{duration:6e5,easing:"linear"}),this.control.setText("zip"),void MapsGPX.plugin.Exporter.handler_zip_gpx.call(this.app,this.app.getKeysOfGPX(),"blob",this.params).then(this.zip_hander)["catch"](function(t){this.params.onInvalid.call(this,t,this.control)}.bind(this)))}.bind({app:this,control:t,zip_hander:n,params:e}))},_exportToDesktopSafari:function(t,e){var n=function(t){var e=document.createElement("a");e.setAttribute("href","data:application/zip;base64,"+t.data),e.setAttribute("download",t.name+".zip"),e.click(),e=null,setTimeout(function(){this.control.hideProgress(),this.params.onLoad.call(this,null,this.control)}.bind(this),2e3)}.bind({control:t,params:e});google.maps.event.addDomListener(t.getElement(),"click",function(t){return this.control.inProgress()?!1:(this.control.showProgress(),this.control.animate(1e3,{duration:6e5,easing:"linear"}),this.control.setText("zip"),void MapsGPX.plugin.Exporter.handler_zip_gpx.call(this.app,this.app.getKeysOfGPX(),"base64",this.params).then(this.zip_hander)["catch"](function(t){this.params.onInvalid.call(this,t,this.control)}.bind(this)))}.bind({app:this,control:t,zip_hander:n,params:e}))},exportToURL:function(t){var e,n,i=t.icon||t.iconUpload;e=MapsGPX.plugin.Exporter.extendControl(MapsGPX.plugin.Exporter.createControl(i),{strokeWidth:5}),e.setMap(this.getMap()),n=function(t){var e=new XMLHttpRequest,n=new FormData;n.append(this.params.name,t.data),e.onprogress=function(t){this.params.onProgress.call(this,t,this.control)}.bind(this),e.onload=function(t){this.params.onLoad.call(this,t,this.control)}.bind(this),e.onerror=function(t){this.params.onError.call(this,t,this.control)}.bind(this),e.onabort=function(t){this.params.onAbort.call(this,t,this.control)}.bind(this),e.upload.onprogress=function(t){this.params.uploadOnProgress.call(this,t,this.control)}.bind(this),e.upload.onload=function(t){this.params.uploadOnLoad.call(this,t,this.control)}.bind(this),e.upload.onerror=function(t){this.params.uploadOnError.call(this,t,this.control)}.bind(this),e.upload.onabort=function(t){this.params.uploadOnAbort.call(this,t,this.control)}.bind(this),e.open(this.params.method,this.params.url),e.send(n)}.bind({control:e,params:t}),google.maps.event.addDomListener(e.getElement(),"click",function(t){return this.control.inProgress()?!1:(this.control.showProgress(),void MapsGPX.plugin.Exporter.handler_zip_gpx.call(this.app,this.app.getKeysOfGPX(),"blob",this.params).then(this.zip_hander)["catch"](function(t){this.params.onInvalid.call(this,t,this.control)}.bind(this)))}.bind({app:this,control:e,zip_hander:n,params:t}))},defaults:{folder:"maps-gpx",iconDownload:"ic_file_download_black_48dp.png",iconUpload:"ic_file_upload_black_48dp.png",method:"POST",paramName:"files[]",url:null,onProgress:function(t,e){},onLoad:function(t,e){t?t.target:null;console.info(t)},onError:function(t,e){},onAbort:function(t,e){},uploadOnProgress:function(t,e){var n;t.lengthComputable&&(n=t.loaded/t.total,e.animateWithText(n,{duration:800}))},uploadOnLoad:function(t,e){e.animateWithText(1,{duration:800}),setTimeout(function(){this.hideProgress()}.bind(e),2e3)},uploadOnError:function(t,e){console.error(t),e.setText("!"),setTimeout(function(){this.hideProgress()}.bind(e),2e3)},uploadOnAbort:function(t,e){e.hideProgress()},validator:function(t){return!0},onInvalid:function(t,e){e.hideProgress(),console.error(t)}},callback:function(t){var e,n,i,r,o={},a=[],s=(t||{}).destinations||[{direction:"DOWNLOAD"}];for(e=0,n=s.length;n>e;++e)i=(s[e].direction||"null").toUpperCase(),"GLOBAL"==i||"DEFAULT"==i||"DEFAULTS"==i?o=s[e]:a.push(s[e]);for(o=MapsGPX.merge({},MapsGPX.plugin.Exporter.defaults,o),this.context.Exporter={docs:{}},this.register("onAddGPX",function(t,e){this.context.Exporter.docs[t]=e}),e=0,n=a.length;n>e;++e)i=a[e].direction||"null",r=MapsGPX.merge({},o,a[e]),"DOWNLOAD"==i.toUpperCase()?MapsGPX.plugin.Exporter.exportToDesktop.call(this,r):"UPLOAD"==i.toUpperCase()?MapsGPX.plugin.Exporter.exportToURL.call(this,r):console.warn("The direction of destination "+i+" is not supported.")}},!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.JSZip=t()}}(function(){return function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return r(n?n:t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t,e){for(var n,r,o,a,s,l,h,u="",c=0;c<t.length;)n=t.charCodeAt(c++),r=t.charCodeAt(c++),o=t.charCodeAt(c++),a=n>>2,s=(3&n)<<4|r>>4,l=(15&r)<<2|o>>6,h=63&o,isNaN(r)?l=h=64:isNaN(o)&&(h=64),u=u+i.charAt(a)+i.charAt(s)+i.charAt(l)+i.charAt(h);return u},n.decode=function(t,e){var n,r,o,a,s,l,h,u="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)a=i.indexOf(t.charAt(c++)),s=i.indexOf(t.charAt(c++)),l=i.indexOf(t.charAt(c++)),h=i.indexOf(t.charAt(c++)),n=a<<2|s>>4,r=(15&s)<<4|l>>2,o=(3&l)<<6|h,u+=String.fromCharCode(n),64!=l&&(u+=String.fromCharCode(r)),64!=h&&(u+=String.fromCharCode(o));return u}},{}],2:[function(t,e,n){"use strict";function i(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}i.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=i},{}],3:[function(t,e,n){"use strict";n.STORE={magic:"\x00\x00",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},n.DEFLATE=t("./flate")},{"./flate":8}],4:[function(t,e,n){"use strict";var i=t("./utils"),r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if("undefined"==typeof t||!t.length)return 0;var n="string"!==i.getTypeOf(t);"undefined"==typeof e&&(e=0);var o=0,a=0,s=0;e=-1^e;for(var l=0,h=t.length;h>l;l++)s=n?t[l]:t.charCodeAt(l),a=255&(e^s),o=r[a],e=e>>>8^o;return-1^e}},{"./utils":21}],5:[function(t,e,n){"use strict";function i(t){this.data=null,this.length=0,this.index=0}var r=t("./utils");i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||0>t)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return r.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=i},{"./utils":21}],6:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],7:[function(t,e,n){"use strict";var i=t("./utils");n.string2binary=function(t){return i.string2binary(t)},n.string2Uint8Array=function(t){return i.transformTo("uint8array",t)},n.uint8Array2String=function(t){return i.transformTo("string",t)},n.string2Blob=function(t){var e=i.transformTo("arraybuffer",t);return i.arrayBuffer2Blob(e)},n.arrayBuffer2Blob=function(t){return i.arrayBuffer2Blob(t)},n.transformTo=function(t,e){return i.transformTo(t,e)},n.getTypeOf=function(t){return i.getTypeOf(t)},n.checkSupport=function(t){return i.checkSupport(t)},n.MAX_VALUE_16BITS=i.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=i.MAX_VALUE_32BITS,n.pretty=function(t){return i.pretty(t)},n.findCompression=function(t){return i.findCompression(t)},n.isRegExp=function(t){return i.isRegExp(t)}},{"./utils":21}],8:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=t("pako");n.uncompressInputType=i?"uint8array":"array",n.compressInputType=i?"uint8array":"array",n.magic="\b\x00",n.compress=function(t,e){return r.deflateRaw(t,{level:e.level||-1})},n.uncompress=function(t){return r.inflateRaw(t)}},{pako:24}],9:[function(t,e,n){"use strict";function i(t,e){return this instanceof i?(this.files={},this.comment=null,this.root="",t&&this.load(t,e),void(this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t})):new i(t,e)}var r=t("./base64");i.prototype=t("./object"),i.prototype.load=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.utils=t("./deprecatedPublicUtils"),i.base64={encode:function(t){return r.encode(t)},decode:function(t){return r.decode(t)}},i.compressions=t("./compressions"),e.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(t,e,n){"use strict";var i=t("./base64"),r=t("./zipEntries");e.exports=function(t,e){var n,o,a,s;for(e=e||{},e.base64&&(t=i.decode(t)),o=new r(t,e),n=o.files,a=0;a<n.length;a++)s=n[a],this.file(s.fileName,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileComment.length?s.fileComment:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders});return o.zipComment.length&&(this.comment=o.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(t,e,n){(function(t){"use strict";e.exports=function(e,n){return new t(e,n)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(t,e,n){"use strict";function i(t){this.data=t,this.length=this.data.length,this.index=0}var r=t("./uint8ArrayReader");i.prototype=new r,i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./uint8ArrayReader":18}],13:[function(t,e,n){"use strict";var i=t("./support"),r=t("./utils"),o=t("./crc32"),a=t("./signature"),s=t("./defaults"),l=t("./base64"),h=t("./compressions"),u=t("./compressedObject"),c=t("./nodeBuffer"),p=t("./utf8"),d=t("./stringWriter"),f=t("./uint8ArrayWriter"),g=function(t){if(t._data instanceof u&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===r.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},m=function(t){var e=g(t),n=r.getTypeOf(e);return"string"===n?!t.options.binary&&i.nodebuffer?c(e,"utf-8"):t.asBinary():e},y=function(t){var e=g(this);return null===e||"undefined"==typeof e?"":(this.options.base64&&(e=l.decode(e)),e=t&&this.options.binary?G.utf8decode(e):r.transformTo("string",e),t||this.options.binary||(e=r.transformTo("string",G.utf8encode(e))),e)},_=function(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}};_.prototype={asText:function(){return y.call(this,!0)},asBinary:function(){return y.call(this,!1)},asNodeBuffer:function(){var t=m(this);return r.transformTo("nodebuffer",t)},asUint8Array:function(){var t=m(this);return r.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var v=function(t,e){var n,i="";for(n=0;e>n;n++)i+=String.fromCharCode(255&t),t>>>=8;return i},b=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"==typeof n[e]&&(n[e]=arguments[t][e]);return n},w=function(t){return t=t||{},t.base64!==!0||null!==t.binary&&void 0!==t.binary||(t.binary=!0),t=b(t,s),t.date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},P=function(t,e,n){var i,o=r.getTypeOf(e);if(n=w(n),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(t=M(t)),n.createFolders&&(i=x(t))&&E.call(this,i,!0),n.dir||null===e||"undefined"==typeof e)n.base64=!1,n.binary=!1,e=null,o=null;else if("string"===o)n.binary&&!n.base64&&n.optimizedBinaryString!==!0&&(e=r.string2binary(e));else{if(n.base64=!1,n.binary=!0,!(o||e instanceof u))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===o&&(e=r.transformTo("uint8array",e))}var a=new _(t,e,n);return this.files[t]=a,a},x=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},M=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},E=function(t,e){return e="undefined"!=typeof e?e:!1,t=M(t),this.files[t]||P.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},k=function(t,e,n){var i,a=new u;return t._data instanceof u?(a.uncompressedSize=t._data.uncompressedSize,a.crc32=t._data.crc32,0===a.uncompressedSize||t.dir?(e=h.STORE,a.compressedContent="",a.crc32=0):t._data.compressionMethod===e.magic?a.compressedContent=t._data.getCompressedContent():(i=t._data.getContent(),a.compressedContent=e.compress(r.transformTo(e.compressInputType,i),n))):(i=m(t),(!i||0===i.length||t.dir)&&(e=h.STORE,i=""),a.uncompressedSize=i.length,a.crc32=o(i),a.compressedContent=e.compress(r.transformTo(e.compressInputType,i),n)),a.compressedSize=a.compressedContent.length,a.compressionMethod=e.magic,a},S=function(t,e){var n=t;return t||(n=e?16893:33204),(65535&n)<<16},T=function(t,e){return 63&(t||0)},C=function(t,e,n,i,s){var l,h,u,c,d=(n.compressedContent,r.transformTo("string",p.utf8encode(e.name))),f=e.comment||"",g=r.transformTo("string",p.utf8encode(f)),m=d.length!==e.name.length,y=g.length!==f.length,_=e.options,b="",w="",P="";u=e._initialMetadata.dir!==e.dir?e.dir:_.dir,c=e._initialMetadata.date!==e.date?e.date:_.date;var x=0,M=0;u&&(x|=16),"UNIX"===s?(M=798,x|=S(e.unixPermissions,u)):(M=20,x|=T(e.dosPermissions,u)),l=c.getHours(),l<<=6,l|=c.getMinutes(),l<<=5,l|=c.getSeconds()/2,h=c.getFullYear()-1980,h<<=4,h|=c.getMonth()+1,h<<=5,h|=c.getDate(),m&&(w=v(1,1)+v(o(d),4)+d,b+="up"+v(w.length,2)+w),y&&(P=v(1,1)+v(this.crc32(g),4)+g,b+="uc"+v(P.length,2)+P);var E="";E+="\n\x00",E+=m||y?"\x00\b":"\x00\x00",E+=n.compressionMethod,E+=v(l,2),E+=v(h,2),E+=v(n.crc32,4),E+=v(n.compressedSize,4),E+=v(n.uncompressedSize,4),E+=v(d.length,2),E+=v(b.length,2);var k=a.LOCAL_FILE_HEADER+E+d+b,C=a.CENTRAL_FILE_HEADER+v(M,2)+E+v(g.length,2)+"\x00\x00\x00\x00"+v(x,4)+v(i,4)+d+b+g;return{fileRecord:k,dirRecord:C,compressedObject:n}},G={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,n,i,r,o=[];for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],r=new _(i.name,i._data,b(i.options)),n=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(n,r)&&o.push(r));return o},file:function(t,e,n){if(1===arguments.length){if(r.isRegExp(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}return this.filter(function(e,n){return!n.dir&&e===t})[0]||null}return t=this.root+t,P.call(this,t,e,n),this},folder:function(t){if(!t)return this;if(r.isRegExp(t))return this.filter(function(e,n){return n.dir&&t.test(e)});var e=this.root+t,n=E.call(this,e),i=this.clone();return i.root=n.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter(function(e,n){return n.name.slice(0,t.length)===t}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(t){t=b(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),r.checkSupport(t.type),("darwin"===t.platform||"freebsd"===t.platform||"linux"===t.platform||"sunos"===t.platform)&&(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,n,i=[],o=0,s=0,u=r.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var c in this.files)if(this.files.hasOwnProperty(c)){var p=this.files[c],g=p.options.compression||t.compression.toUpperCase(),m=h[g];if(!m)throw new Error(g+" is not a valid compression method !");var y=p.options.compressionOptions||t.compressionOptions||{},_=k.call(this,p,m,y),w=C.call(this,c,p,_,o,t.platform);o+=w.fileRecord.length+_.compressedSize,s+=w.dirRecord.length,i.push(w)}var P="";P=a.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+v(i.length,2)+v(i.length,2)+v(s,4)+v(o,4)+v(u.length,2)+u;var x=t.type.toLowerCase();for(e="uint8array"===x||"arraybuffer"===x||"blob"===x||"nodebuffer"===x?new f(o+s+P.length):new d(o+s+P.length),n=0;n<i.length;n++)e.append(i[n].fileRecord),e.append(i[n].compressedObject.compressedContent);for(n=0;n<i.length;n++)e.append(i[n].dirRecord);e.append(P);var M=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return r.transformTo(t.type.toLowerCase(),M);case"blob":return r.arrayBuffer2Blob(r.transformTo("arraybuffer",M),t.mimeType);case"base64":return t.base64?l.encode(M):M;default:return M}},crc32:function(t,e){return o(t,e)},utf8encode:function(t){return r.transformTo("string",p.utf8encode(t))},utf8decode:function(t){return p.utf8decode(t)}};e.exports=G},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],15:[function(t,e,n){"use strict";function i(t,e){this.data=t,e||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0}var r=t("./dataReader"),o=t("./utils");i.prototype=new r,i.prototype.byteAt=function(t){return this.data.charCodeAt(t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5,"./utils":21}],16:[function(t,e,n){"use strict";var i=t("./utils"),r=function(){this.data=[]};r.prototype={append:function(t){t=i.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=r},{"./utils":21}],17:[function(t,e,n){(function(t){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof t,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var e=new ArrayBuffer(0);try{n.blob=0===new Blob([e],{type:"application/zip"}).size}catch(i){try{var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new r;o.append(e),n.blob=0===o.getBlob("application/zip").size}catch(i){n.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(t,e,n){"use strict";function i(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}var r=t("./dataReader");i.prototype=new r,i.prototype.byteAt=function(t){return this.data[t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===i&&this.data[o+3]===r)return o;return-1},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5}],19:[function(t,e,n){"use strict";var i=t("./utils"),r=function(t){this.data=new Uint8Array(t),this.index=0};r.prototype={append:function(t){0!==t.length&&(t=i.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=r},{"./utils":21}],20:[function(t,e,n){"use strict";for(var i=t("./utils"),r=t("./support"),o=t("./nodeBuffer"),a=new Array(256),s=0;256>s;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;a[254]=a[254]=1;var l=function(t){var e,n,i,o,a,s=t.length,l=0;for(o=0;s>o;o++)n=t.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),l+=128>n?1:2048>n?2:65536>n?3:4;for(e=r.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;l>a;o++)n=t.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),128>n?e[a++]=n:2048>n?(e[a++]=192|n>>>6,e[a++]=128|63&n):65536>n?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},h=function(t,e){var n;for(e=e||t.length,e>t.length&&(e=t.length),n=e-1;n>=0&&128===(192&t[n]);)n--;return 0>n?e:0===n?e:n+a[t[n]]>e?n:e},u=function(t){var e,n,r,o,s=t.length,l=new Array(2*s);for(n=0,e=0;s>e;)if(r=t[e++],128>r)l[n++]=r;else if(o=a[r],o>4)l[n++]=65533,e+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&s>e;)r=r<<6|63&t[e++],o--;o>1?l[n++]=65533:65536>r?l[n++]=r:(r-=65536,l[n++]=55296|r>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),i.applyFromCharCode(l)};n.utf8encode=function(t){return r.nodebuffer?o(t,"utf-8"):l(t)},n.utf8decode=function(t){if(r.nodebuffer)return i.transformTo("nodebuffer",t).toString("utf-8");t=i.transformTo(r.uint8array?"uint8array":"array",t);for(var e=[],n=0,o=t.length,a=65536;o>n;){var s=h(t,Math.min(n+a,o));r.uint8array?e.push(u(t.subarray(n,s))):e.push(u(t.slice(n,s))),n=s}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(t,e,n){"use strict";function i(t){return t}function r(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}function o(t){var e=65536,i=[],r=t.length,o=n.getTypeOf(t),a=0,s=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,h(0))}}catch(l){s=!1}if(!s){for(var u="",c=0;c<t.length;c++)u+=String.fromCharCode(t[c]);return u}for(;r>a&&e>1;)try{"array"===o||"nodebuffer"===o?i.push(String.fromCharCode.apply(null,t.slice(a,Math.min(a+e,r)))):i.push(String.fromCharCode.apply(null,t.subarray(a,Math.min(a+e,r)))),a+=e}catch(l){e=Math.floor(e/2)}return i.join("")}function a(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}var s=t("./support"),l=t("./compressions"),h=t("./nodeBuffer");n.string2binary=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n));return e},n.arrayBuffer2Blob=function(t,e){n.checkSupport("blob"),e=e||"application/zip";try{return new Blob([t],{type:e})}catch(i){try{var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new r;return o.append(t),o.getBlob(e)}catch(i){throw new Error("Bug : can't construct the Blob.")}}},n.applyFromCharCode=o;var u={};u.string={string:i,array:function(t){return r(t,new Array(t.length))},arraybuffer:function(t){return u.string.uint8array(t).buffer},uint8array:function(t){return r(t,new Uint8Array(t.length))},nodebuffer:function(t){return r(t,h(t.length))}},u.array={string:o,array:i,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return h(t)}},u.arraybuffer={string:function(t){return o(new Uint8Array(t))},array:function(t){return a(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:i,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return h(new Uint8Array(t))}},u.uint8array={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:i,nodebuffer:function(t){return h(t)}},u.nodebuffer={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return u.nodebuffer.uint8array(t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:i},n.transformTo=function(t,e){if(e||(e=""),!t)return e;n.checkSupport(t);var i=n.getTypeOf(e),r=u[i][t](e);return r},n.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":s.nodebuffer&&h.test(t)?"nodebuffer":s.uint8array&&t instanceof Uint8Array?"uint8array":s.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(t){var e=s[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this browser")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(t){var e,n,i="";for(n=0;n<(t||"").length;n++)e=t.charCodeAt(n),i+="\\x"+(16>e?"0":"")+e.toString(16).toUpperCase();return i},n.findCompression=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null},n.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(t,e,n){"use strict";function i(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}var r=t("./stringReader"),o=t("./nodeBufferReader"),a=t("./uint8ArrayReader"),s=t("./utils"),l=t("./signature"),h=t("./zipEntry"),u=t("./support"),c=t("./object");i.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(e)+", expected "+s.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,i=this.zip64EndOfCentralSize-44,r=0;i>r;)t=this.reader.readInt(2),
e=this.reader.readInt(4),n=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===l.CENTRAL_FILE_HEADER;)t=new h({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(-1===t){var e=!0;try{this.reader.setIndex(0),this.checkSignature(l.LOCAL_FILE_HEADER),e=!1}catch(n){}throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===t)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=s.getTypeOf(t);"string"!==e||u.uint8array?"nodebuffer"===e?this.reader=new o(t):this.reader=new a(s.transformTo("uint8array",t)):this.reader=new r(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=i},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(t,e,n){"use strict";function i(t,e){this.options=t,this.loadOptions=e}var r=t("./stringReader"),o=t("./utils"),a=t("./compressedObject"),s=t("./object"),l=0,h=3;i.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(t,e,n){return function(){var i=t.index;t.setIndex(e);var r=t.readData(n);return t.setIndex(i),r}},prepareContent:function(t,e,n,i,r){return function(){var t=o.transformTo(i.uncompressInputType,this.getCompressedContent()),e=i.uncompress(t);if(e.length!==r)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(n),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(e=o.findCompression(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=16&this.externalFileAttributes?!0:!1,t===l&&(this.dosPermissions=63&this.externalFileAttributes),t===h&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new r(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,i,r=t.index;for(this.extraFields=this.extraFields||{};t.index<r+this.extraFieldsLength;)e=t.readInt(2),n=t.readInt(2),i=t.readString(n),this.extraFields[e]={id:e,length:n,value:i}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new r(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new r(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null}},e.exports=i},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(t,e,n){"use strict";var i=t("./lib/utils/common").assign,r=t("./lib/deflate"),o=t("./lib/inflate"),a=t("./lib/zlib/constants"),s={};i(s,r,o,a),e.exports=s},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(t,e,n){"use strict";function i(t,e){var n=new _(e);if(n.push(t,!0),n.err)throw n.msg;return n.result}function r(t,e){return e=e||{},e.raw=!0,i(t,e)}function o(t,e){return e=e||{},e.gzip=!0,i(t,e)}var a=t("./zlib/deflate.js"),s=t("./utils/common"),l=t("./utils/strings"),h=t("./zlib/messages"),u=t("./zlib/zstream"),c=0,p=4,d=0,f=1,g=-1,m=0,y=8,_=function(t){this.options=s.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==d)throw new Error(h[n]);e.header&&a.deflateSetHeader(this.strm,e.header)};_.prototype.push=function(t,e){var n,i,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?p:c,"string"==typeof t?r.input=l.string2buf(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new s.Buf8(o),r.next_out=0,r.avail_out=o),n=a.deflate(r,i),n!==f&&n!==d)return this.onEnd(n),this.ended=!0,!1;(0===r.avail_out||0===r.avail_in&&i===p)&&("string"===this.options.to?this.onData(l.buf2binstring(s.shrinkBuf(r.output,r.next_out))):this.onData(s.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||0===r.avail_out)&&n!==f);return i===p?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===d):!0},_.prototype.onData=function(t){this.chunks.push(t)},_.prototype.onEnd=function(t){t===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=_,n.deflate=i,n.deflateRaw=r,n.gzip=o},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(t,e,n){"use strict";function i(t,e){var n=new p(e);if(n.push(t,!0),n.err)throw n.msg;return n.result}function r(t,e){return e=e||{},e.raw=!0,i(t,e)}var o=t("./zlib/inflate.js"),a=t("./utils/common"),s=t("./utils/strings"),l=t("./zlib/constants"),h=t("./zlib/messages"),u=t("./zlib/zstream"),c=t("./zlib/gzheader"),p=function(t){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=o.inflateInit2(this.strm,e.windowBits);if(n!==l.Z_OK)throw new Error(h[n]);this.header=new c,o.inflateGetHeader(this.strm,this.header)};p.prototype.push=function(t,e){var n,i,r,h,u,c=this.strm,p=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:e===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?c.input=s.binstring2buf(t):c.input=t,c.next_in=0,c.avail_in=c.input.length;do{if(0===c.avail_out&&(c.output=new a.Buf8(p),c.next_out=0,c.avail_out=p),n=o.inflate(c,l.Z_NO_FLUSH),n!==l.Z_STREAM_END&&n!==l.Z_OK)return this.onEnd(n),this.ended=!0,!1;c.next_out&&(0===c.avail_out||n===l.Z_STREAM_END||0===c.avail_in&&i===l.Z_FINISH)&&("string"===this.options.to?(r=s.utf8border(c.output,c.next_out),h=c.next_out-r,u=s.buf2string(c.output,r),c.next_out=h,c.avail_out=p-h,h&&a.arraySet(c.output,c.output,r,h,0),this.onData(u)):this.onData(a.shrinkBuf(c.output,c.next_out)))}while(c.avail_in>0&&n!==l.Z_STREAM_END);return n===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(n=o.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===l.Z_OK):!0},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=p,n.inflate=i,n.inflateRaw=r,n.ungzip=i},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)return void t.set(e.subarray(n,n+i),r);for(var o=0;i>o;o++)t[r+o]=e[n+o]},flattenChunks:function(t){var e,n,i,r,o,a;for(i=0,e=0,n=t.length;n>e;e++)i+=t[e].length;for(a=new Uint8Array(i),r=0,e=0,n=t.length;n>e;e++)o=t[e],a.set(o,r),r+=o.length;return a}},o={arraySet:function(t,e,n,i,r){for(var o=0;i>o;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],28:[function(t,e,n){"use strict";function i(t,e){if(65537>e&&(t.subarray&&a||!t.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",i=0;e>i;i++)n+=String.fromCharCode(t[i]);return n}var r=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(s){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){a=!1}for(var l=new r.Buf8(256),h=0;256>h;h++)l[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;l[254]=l[254]=1,n.string2buf=function(t){var e,n,i,o,a,s=t.length,l=0;for(o=0;s>o;o++)n=t.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),l+=128>n?1:2048>n?2:65536>n?3:4;for(e=new r.Buf8(l),a=0,o=0;l>a;o++)n=t.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=t.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),128>n?e[a++]=n:2048>n?(e[a++]=192|n>>>6,e[a++]=128|63&n):65536>n?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},n.buf2binstring=function(t){return i(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;i>n;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,o,a,s=e||t.length,h=new Array(2*s);for(r=0,n=0;s>n;)if(o=t[n++],128>o)h[r++]=o;else if(a=l[o],a>4)h[r++]=65533,n+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&s>n;)o=o<<6|63&t[n++],a--;a>1?h[r++]=65533:65536>o?h[r++]=o:(o-=65536,h[r++]=55296|o>>10&1023,h[r++]=56320|1023&o)}return i(h,r)},n.utf8border=function(t,e){var n;for(e=e||t.length,e>t.length&&(e=t.length),n=e-1;n>=0&&128===(192&t[n]);)n--;return 0>n?e:0===n?e:n+l[t[n]]>e?n:e}},{"./common":27}],29:[function(t,e,n){"use strict";function i(t,e,n,i){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do r=r+e[i++]|0,o=o+r|0;while(--a);r%=65521,o%=65521}return r|o<<16|0}e.exports=i},{}],30:[function(t,e,n){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(t,e,n){"use strict";function i(){for(var t,e=[],n=0;256>n;n++){t=n;for(var i=0;8>i;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}function r(t,e,n,i){var r=o,a=i+n;t=-1^t;for(var s=i;a>s;s++)t=t>>>8^r[255&(t^e[s])];return-1^t}var o=i();e.exports=r},{}],32:[function(t,e,n){"use strict";function i(t,e){return t.msg=X[e],e}function r(t){return(t<<1)-(t>4?9:0)}function o(t){for(var e=t.length;--e>=0;)t[e]=0}function a(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(T.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function s(t,e){C._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,a(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function h(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function u(t,e,n,i){var r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,T.arraySet(e,t.input,t.next_in,r,n),1===t.state.wrap?t.adler=G(t.adler,e,r,n):2===t.state.wrap&&(t.adler=L(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)}function c(t,e){var n,i,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-ht?t.strstart-(t.w_size-ht):0,h=t.window,u=t.w_mask,c=t.prev,p=t.strstart+lt,d=h[o+a-1],f=h[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do if(n=e,h[n+a]===f&&h[n+a-1]===d&&h[n]===h[o]&&h[++n]===h[o+1]){o+=2,n++;do;while(h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&p>o);if(i=lt-(p-o),o=p-lt,i>a){if(t.match_start=e,a=i,i>=s)break;d=h[o+a-1],f=h[o+a]}}while((e=c[e&u])>l&&0!==--r);return a<=t.lookahead?a:t.lookahead}function p(t){var e,n,i,r,o,a=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=a+(a-ht)){T.arraySet(t.window,t.window,a,a,0),t.match_start-=a,t.strstart-=a,t.block_start-=a,n=t.hash_size,e=n;do i=t.head[--e],t.head[e]=i>=a?i-a:0;while(--n);n=a,e=n;do i=t.prev[--e],t.prev[e]=i>=a?i-a:0;while(--n);r+=a}if(0===t.strm.avail_in)break;if(n=u(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=n,t.lookahead+t.insert>=st)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+st-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<st)););}while(t.lookahead<ht&&0!==t.strm.avail_in)}function d(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(p(t),0===t.lookahead&&e===A)return _t;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,s(t,!1),0===t.strm.avail_out))return _t;if(t.strstart-t.block_start>=t.w_size-ht&&(s(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?bt:wt):t.strstart>t.block_start&&(s(t,!1),0===t.strm.avail_out)?_t:_t}function f(t,e){for(var n,i;;){if(t.lookahead<ht){if(p(t),t.lookahead<ht&&e===A)return _t;if(0===t.lookahead)break}if(n=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-ht&&(t.match_length=c(t,n)),t.match_length>=st)if(i=C._tr_tally(t,t.strstart-t.match_start,t.match_length-st),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=st){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=C._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(s(t,!1),0===t.strm.avail_out))return _t}return t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?bt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?_t:vt}function g(t,e){for(var n,i,r;;){if(t.lookahead<ht){if(p(t),t.lookahead<ht&&e===A)return _t;if(0===t.lookahead)break}if(n=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=st-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-ht&&(t.match_length=c(t,n),t.match_length<=5&&(t.strategy===$||t.match_length===st&&t.strstart-t.match_start>4096)&&(t.match_length=st-1)),t.prev_length>=st&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-st,i=C._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-st),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=st-1,t.strstart++,i&&(s(t,!1),0===t.strm.avail_out))return _t}else if(t.match_available){if(i=C._tr_tally(t,0,t.window[t.strstart-1]),i&&s(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return _t}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=C._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<st-1?t.strstart:st-1,e===D?(s(t,!0),0===t.strm.avail_out?bt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?_t:vt}function m(t,e){for(var n,i,r,o,a=t.window;;){if(t.lookahead<=lt){if(p(t),t.lookahead<=lt&&e===A)return _t;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=st&&t.strstart>0&&(r=t.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){o=t.strstart+lt;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&o>r);t.match_length=lt-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=st?(n=C._tr_tally(t,1,t.match_length-st),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=C._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(s(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?bt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?_t:vt}function y(t,e){for(var n;;){if(0===t.lookahead&&(p(t),0===t.lookahead)){if(e===A)return _t;break}if(t.match_length=0,n=C._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(s(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===D?(s(t,!0),0===t.strm.avail_out?bt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?_t:vt}function _(t){t.window_size=2*t.w_size,o(t.head),t.max_lazy_match=S[t.level].max_lazy,t.good_match=S[t.level].good_length,t.nice_match=S[t.level].nice_length,t.max_chain_length=S[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=st-1,t.match_available=0,t.ins_h=0}function v(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new T.Buf16(2*ot),this.dyn_dtree=new T.Buf16(2*(2*it+1)),this.bl_tree=new T.Buf16(2*(2*rt+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new T.Buf16(at+1),this.heap=new T.Buf16(2*nt+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new T.Buf16(2*nt+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function b(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=K,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ct:mt,t.adler=2===e.wrap?0:1,e.last_flush=A,C._tr_init(e),R):i(t,B)}function w(t){var e=b(t);return e===R&&_(t.state),e}function P(t,e){return t&&t.state?2!==t.state.wrap?B:(t.state.gzhead=e,R):B}function x(t,e,n,r,o,a){if(!t)return B;var s=1;if(e===U&&(e=6),0>r?(s=0,r=-r):r>15&&(s=2,r-=16),1>o||o>Y||n!==q||8>r||r>15||0>e||e>9||0>a||a>V)return i(t,B);8===r&&(r=9);var l=new v;return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+st-1)/st),l.window=new T.Buf8(2*l.w_size),l.head=new T.Buf16(l.hash_size),l.prev=new T.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new T.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=n,w(t)}function M(t,e){return x(t,e,q,J,Q,Z)}function E(t,e){var n,s,u,c;if(!t||!t.state||e>N||0>e)return t?i(t,B):B;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||s.status===yt&&e!==D)return i(t,0===t.avail_out?j:B);if(s.strm=t,n=s.last_flush,s.last_flush=e,s.status===ct)if(2===s.wrap)t.adler=0,l(s,31),l(s,139),l(s,8),s.gzhead?(l(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),l(s,255&s.gzhead.time),l(s,s.gzhead.time>>8&255),l(s,s.gzhead.time>>16&255),l(s,s.gzhead.time>>24&255),l(s,9===s.level?2:s.strategy>=W||s.level<2?4:0),l(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(l(s,255&s.gzhead.extra.length),l(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=L(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=pt):(l(s,0),l(s,0),l(s,0),l(s,0),l(s,0),l(s,9===s.level?2:s.strategy>=W||s.level<2?4:0),l(s,Pt),s.status=mt);else{var p=q+(s.w_bits-8<<4)<<8,d=-1;d=s.strategy>=W||s.level<2?0:s.level<6?1:6===s.level?2:3,p|=d<<6,0!==s.strstart&&(p|=ut),p+=31-p%31,s.status=mt,h(s,p),0!==s.strstart&&(h(s,t.adler>>>16),h(s,65535&t.adler)),t.adler=1}if(s.status===pt)if(s.gzhead.extra){for(u=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),a(t),u=s.pending,s.pending!==s.pending_buf_size));)l(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=dt)}else s.status=dt;if(s.status===dt)if(s.gzhead.name){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),a(t),u=s.pending,s.pending===s.pending_buf_size)){c=1;break}c=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,l(s,c)}while(0!==c);s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),0===c&&(s.gzindex=0,s.status=ft)}else s.status=ft;if(s.status===ft)if(s.gzhead.comment){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),a(t),u=s.pending,s.pending===s.pending_buf_size)){c=1;break}c=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,l(s,c)}while(0!==c);s.gzhead.hcrc&&s.pending>u&&(t.adler=L(t.adler,s.pending_buf,s.pending-u,u)),0===c&&(s.status=gt)}else s.status=gt;if(s.status===gt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(t),s.pending+2<=s.pending_buf_size&&(l(s,255&t.adler),l(s,t.adler>>8&255),t.adler=0,s.status=mt)):s.status=mt),0!==s.pending){if(a(t),0===t.avail_out)return s.last_flush=-1,R}else if(0===t.avail_in&&r(e)<=r(n)&&e!==D)return i(t,j);if(s.status===yt&&0!==t.avail_in)return i(t,j);if(0!==t.avail_in||0!==s.lookahead||e!==A&&s.status!==yt){var f=s.strategy===W?y(s,e):s.strategy===H?m(s,e):S[s.level].func(s,e);if((f===bt||f===wt)&&(s.status=yt),f===_t||f===bt)return 0===t.avail_out&&(s.last_flush=-1),R;if(f===vt&&(e===O?C._tr_align(s):e!==N&&(C._tr_stored_block(s,0,0,!1),e===I&&(o(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(t),0===t.avail_out))return s.last_flush=-1,R}return e!==D?R:s.wrap<=0?z:(2===s.wrap?(l(s,255&t.adler),l(s,t.adler>>8&255),l(s,t.adler>>16&255),l(s,t.adler>>24&255),l(s,255&t.total_in),l(s,t.total_in>>8&255),l(s,t.total_in>>16&255),l(s,t.total_in>>24&255)):(h(s,t.adler>>>16),h(s,65535&t.adler)),a(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?R:z)}function k(t){var e;return t&&t.state?(e=t.state.status,e!==ct&&e!==pt&&e!==dt&&e!==ft&&e!==gt&&e!==mt&&e!==yt?i(t,B):(t.state=null,e===mt?i(t,F):R)):B}var S,T=t("../utils/common"),C=t("./trees"),G=t("./adler32"),L=t("./crc32"),X=t("./messages"),A=0,O=1,I=3,D=4,N=5,R=0,z=1,B=-2,F=-3,j=-5,U=-1,$=1,W=2,H=3,V=4,Z=0,K=2,q=8,Y=9,J=15,Q=8,tt=29,et=256,nt=et+1+tt,it=30,rt=19,ot=2*nt+1,at=15,st=3,lt=258,ht=lt+st+1,ut=32,ct=42,pt=69,dt=73,ft=91,gt=103,mt=113,yt=666,_t=1,vt=2,bt=3,wt=4,Pt=3,xt=function(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r};S=[new xt(0,0,0,0,d),new xt(4,4,8,4,f),new xt(4,5,16,8,f),new xt(4,6,32,32,f),new xt(4,4,16,16,g),new xt(8,16,32,32,g),new xt(8,16,128,128,g),new xt(8,32,128,256,g),new xt(32,128,258,1024,g),new xt(32,258,258,4096,g)],n.deflateInit=M,n.deflateInit2=x,n.deflateReset=w,n.deflateResetKeep=b,n.deflateSetHeader=P,n.deflate=E,n.deflateEnd=k,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(t,e,n){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=i},{}],34:[function(t,e,n){"use strict";var i=30,r=12;e.exports=function(t,e){var n,o,a,s,l,h,u,c,p,d,f,g,m,y,_,v,b,w,P,x,M,E,k,S,T;n=t.state,o=t.next_in,S=t.input,a=o+(t.avail_in-5),s=t.next_out,T=t.output,l=s-(e-t.avail_out),h=s+(t.avail_out-257),u=n.dmax,c=n.wsize,p=n.whave,d=n.wnext,f=n.window,g=n.hold,m=n.bits,y=n.lencode,_=n.distcode,v=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;t:do{15>m&&(g+=S[o++]<<m,m+=8,g+=S[o++]<<m,m+=8),w=y[g&v];e:for(;;){if(P=w>>>24,g>>>=P,m-=P,P=w>>>16&255,0===P)T[s++]=65535&w;else{if(!(16&P)){if(0===(64&P)){w=y[(65535&w)+(g&(1<<P)-1)];continue e}if(32&P){n.mode=r;break t}t.msg="invalid literal/length code",n.mode=i;break t}x=65535&w,P&=15,P&&(P>m&&(g+=S[o++]<<m,m+=8),x+=g&(1<<P)-1,g>>>=P,m-=P),15>m&&(g+=S[o++]<<m,m+=8,g+=S[o++]<<m,m+=8),w=_[g&b];n:for(;;){if(P=w>>>24,g>>>=P,m-=P,P=w>>>16&255,!(16&P)){if(0===(64&P)){w=_[(65535&w)+(g&(1<<P)-1)];continue n}t.msg="invalid distance code",n.mode=i;break t}if(M=65535&w,P&=15,P>m&&(g+=S[o++]<<m,m+=8,P>m&&(g+=S[o++]<<m,m+=8)),M+=g&(1<<P)-1,M>u){t.msg="invalid distance too far back",n.mode=i;break t}if(g>>>=P,m-=P,P=s-l,M>P){if(P=M-P,P>p&&n.sane){t.msg="invalid distance too far back",n.mode=i;break t}if(E=0,k=f,0===d){if(E+=c-P,x>P){x-=P;do T[s++]=f[E++];while(--P);E=s-M,k=T}}else if(P>d){if(E+=c+d-P,P-=d,x>P){x-=P;do T[s++]=f[E++];while(--P);if(E=0,x>d){P=d,x-=P;do T[s++]=f[E++];while(--P);E=s-M,k=T}}}else if(E+=d-P,x>P){x-=P;do T[s++]=f[E++];while(--P);E=s-M,k=T}for(;x>2;)T[s++]=k[E++],T[s++]=k[E++],T[s++]=k[E++],x-=3;x&&(T[s++]=k[E++],x>1&&(T[s++]=k[E++]))}else{E=s-M;do T[s++]=T[E++],T[s++]=T[E++],T[s++]=T[E++],x-=3;while(x>2);x&&(T[s++]=T[E++],x>1&&(T[s++]=T[E++]))}break}}break}}while(a>o&&h>s);x=m>>3,o-=x,m-=x<<3,g&=(1<<m)-1,t.next_in=o,t.next_out=s,t.avail_in=a>o?5+(a-o):5-(o-a),t.avail_out=h>s?257+(h-s):257-(s-h),n.hold=g,n.bits=m}},{}],35:[function(t,e,n){"use strict";function i(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=D,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new y.Buf32(ft),e.distcode=e.distdyn=new y.Buf32(gt),e.sane=1,e.back=-1,T):L}function a(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,o(t)):L}function s(t,e){var n,i;return t&&t.state?(i=t.state,0>e?(n=0,e=-e):(n=(e>>4)+1,48>e&&(e&=15)),e&&(8>e||e>15)?L:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,a(t))):L}function l(t,e){var n,i;
return t?(i=new r,t.state=i,i.window=null,n=s(t,e),n!==T&&(t.state=null),n):L}function h(t){return l(t,yt)}function u(t){if(_t){var e;for(g=new y.Buf32(512),m=new y.Buf32(32),e=0;144>e;)t.lens[e++]=8;for(;256>e;)t.lens[e++]=9;for(;280>e;)t.lens[e++]=7;for(;288>e;)t.lens[e++]=8;for(w(x,t.lens,0,288,g,0,t.work,{bits:9}),e=0;32>e;)t.lens[e++]=5;w(M,t.lens,0,32,m,0,t.work,{bits:5}),_t=!1}t.lencode=g,t.lenbits=9,t.distcode=m,t.distbits=5}function c(t,e,n,i){var r,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),i>=o.wsize?(y.arraySet(o.window,e,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),y.arraySet(o.window,e,n-i,r,o.wnext),i-=r,i?(y.arraySet(o.window,e,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}function p(t,e){var n,r,o,a,s,l,h,p,d,f,g,m,ft,gt,mt,yt,_t,vt,bt,wt,Pt,xt,Mt,Et,kt=0,St=new y.Buf8(4),Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return L;n=t.state,n.mode===V&&(n.mode=Z),s=t.next_out,o=t.output,h=t.avail_out,a=t.next_in,r=t.input,l=t.avail_in,p=n.hold,d=n.bits,f=l,g=h,xt=T;t:for(;;)switch(n.mode){case D:if(0===n.wrap){n.mode=Z;break}for(;16>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(2&n.wrap&&35615===p){n.check=0,St[0]=255&p,St[1]=p>>>8&255,n.check=v(n.check,St,2,0),p=0,d=0,n.mode=N;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){t.msg="incorrect header check",n.mode=ct;break}if((15&p)!==I){t.msg="unknown compression method",n.mode=ct;break}if(p>>>=4,d-=4,Pt=(15&p)+8,0===n.wbits)n.wbits=Pt;else if(Pt>n.wbits){t.msg="invalid window size",n.mode=ct;break}n.dmax=1<<Pt,t.adler=n.check=1,n.mode=512&p?W:V,p=0,d=0;break;case N:for(;16>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(n.flags=p,(255&n.flags)!==I){t.msg="unknown compression method",n.mode=ct;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=ct;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(St[0]=255&p,St[1]=p>>>8&255,n.check=v(n.check,St,2,0)),p=0,d=0,n.mode=R;case R:for(;32>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.head&&(n.head.time=p),512&n.flags&&(St[0]=255&p,St[1]=p>>>8&255,St[2]=p>>>16&255,St[3]=p>>>24&255,n.check=v(n.check,St,4,0)),p=0,d=0,n.mode=z;case z:for(;16>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(St[0]=255&p,St[1]=p>>>8&255,n.check=v(n.check,St,2,0)),p=0,d=0,n.mode=B;case B:if(1024&n.flags){for(;16>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(St[0]=255&p,St[1]=p>>>8&255,n.check=v(n.check,St,2,0)),p=0,d=0}else n.head&&(n.head.extra=null);n.mode=F;case F:if(1024&n.flags&&(m=n.length,m>l&&(m=l),m&&(n.head&&(Pt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),y.arraySet(n.head.extra,r,a,m,Pt)),512&n.flags&&(n.check=v(n.check,r,m,a)),l-=m,a+=m,n.length-=m),n.length))break t;n.length=0,n.mode=j;case j:if(2048&n.flags){if(0===l)break t;m=0;do Pt=r[a+m++],n.head&&Pt&&n.length<65536&&(n.head.name+=String.fromCharCode(Pt));while(Pt&&l>m);if(512&n.flags&&(n.check=v(n.check,r,m,a)),l-=m,a+=m,Pt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=U;case U:if(4096&n.flags){if(0===l)break t;m=0;do Pt=r[a+m++],n.head&&Pt&&n.length<65536&&(n.head.comment+=String.fromCharCode(Pt));while(Pt&&l>m);if(512&n.flags&&(n.check=v(n.check,r,m,a)),l-=m,a+=m,Pt)break t}else n.head&&(n.head.comment=null);n.mode=$;case $:if(512&n.flags){for(;16>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(p!==(65535&n.check)){t.msg="header crc mismatch",n.mode=ct;break}p=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=V;break;case W:for(;32>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}t.adler=n.check=i(p),p=0,d=0,n.mode=H;case H:if(0===n.havedict)return t.next_out=s,t.avail_out=h,t.next_in=a,t.avail_in=l,n.hold=p,n.bits=d,G;t.adler=n.check=1,n.mode=V;case V:if(e===k||e===S)break t;case Z:if(n.last){p>>>=7&d,d-=7&d,n.mode=lt;break}for(;3>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}switch(n.last=1&p,p>>>=1,d-=1,3&p){case 0:n.mode=K;break;case 1:if(u(n),n.mode=et,e===S){p>>>=2,d-=2;break t}break;case 2:n.mode=J;break;case 3:t.msg="invalid block type",n.mode=ct}p>>>=2,d-=2;break;case K:for(p>>>=7&d,d-=7&d;32>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if((65535&p)!==(p>>>16^65535)){t.msg="invalid stored block lengths",n.mode=ct;break}if(n.length=65535&p,p=0,d=0,n.mode=q,e===S)break t;case q:n.mode=Y;case Y:if(m=n.length){if(m>l&&(m=l),m>h&&(m=h),0===m)break t;y.arraySet(o,r,a,m,s),l-=m,a+=m,h-=m,s+=m,n.length-=m;break}n.mode=V;break;case J:for(;14>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(n.nlen=(31&p)+257,p>>>=5,d-=5,n.ndist=(31&p)+1,p>>>=5,d-=5,n.ncode=(15&p)+4,p>>>=4,d-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=ct;break}n.have=0,n.mode=Q;case Q:for(;n.have<n.ncode;){for(;3>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.lens[Tt[n.have++]]=7&p,p>>>=3,d-=3}for(;n.have<19;)n.lens[Tt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Mt={bits:n.lenbits},xt=w(P,n.lens,0,19,n.lencode,0,n.work,Mt),n.lenbits=Mt.bits,xt){t.msg="invalid code lengths set",n.mode=ct;break}n.have=0,n.mode=tt;case tt:for(;n.have<n.nlen+n.ndist;){for(;kt=n.lencode[p&(1<<n.lenbits)-1],mt=kt>>>24,yt=kt>>>16&255,_t=65535&kt,!(d>=mt);){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(16>_t)p>>>=mt,d-=mt,n.lens[n.have++]=_t;else{if(16===_t){for(Et=mt+2;Et>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(p>>>=mt,d-=mt,0===n.have){t.msg="invalid bit length repeat",n.mode=ct;break}Pt=n.lens[n.have-1],m=3+(3&p),p>>>=2,d-=2}else if(17===_t){for(Et=mt+3;Et>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}p>>>=mt,d-=mt,Pt=0,m=3+(7&p),p>>>=3,d-=3}else{for(Et=mt+7;Et>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}p>>>=mt,d-=mt,Pt=0,m=11+(127&p),p>>>=7,d-=7}if(n.have+m>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=ct;break}for(;m--;)n.lens[n.have++]=Pt}}if(n.mode===ct)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=ct;break}if(n.lenbits=9,Mt={bits:n.lenbits},xt=w(x,n.lens,0,n.nlen,n.lencode,0,n.work,Mt),n.lenbits=Mt.bits,xt){t.msg="invalid literal/lengths set",n.mode=ct;break}if(n.distbits=6,n.distcode=n.distdyn,Mt={bits:n.distbits},xt=w(M,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Mt),n.distbits=Mt.bits,xt){t.msg="invalid distances set",n.mode=ct;break}if(n.mode=et,e===S)break t;case et:n.mode=nt;case nt:if(l>=6&&h>=258){t.next_out=s,t.avail_out=h,t.next_in=a,t.avail_in=l,n.hold=p,n.bits=d,b(t,g),s=t.next_out,o=t.output,h=t.avail_out,a=t.next_in,r=t.input,l=t.avail_in,p=n.hold,d=n.bits,n.mode===V&&(n.back=-1);break}for(n.back=0;kt=n.lencode[p&(1<<n.lenbits)-1],mt=kt>>>24,yt=kt>>>16&255,_t=65535&kt,!(d>=mt);){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(yt&&0===(240&yt)){for(vt=mt,bt=yt,wt=_t;kt=n.lencode[wt+((p&(1<<vt+bt)-1)>>vt)],mt=kt>>>24,yt=kt>>>16&255,_t=65535&kt,!(d>=vt+mt);){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}p>>>=vt,d-=vt,n.back+=vt}if(p>>>=mt,d-=mt,n.back+=mt,n.length=_t,0===yt){n.mode=st;break}if(32&yt){n.back=-1,n.mode=V;break}if(64&yt){t.msg="invalid literal/length code",n.mode=ct;break}n.extra=15&yt,n.mode=it;case it:if(n.extra){for(Et=n.extra;Et>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=rt;case rt:for(;kt=n.distcode[p&(1<<n.distbits)-1],mt=kt>>>24,yt=kt>>>16&255,_t=65535&kt,!(d>=mt);){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(0===(240&yt)){for(vt=mt,bt=yt,wt=_t;kt=n.distcode[wt+((p&(1<<vt+bt)-1)>>vt)],mt=kt>>>24,yt=kt>>>16&255,_t=65535&kt,!(d>=vt+mt);){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}p>>>=vt,d-=vt,n.back+=vt}if(p>>>=mt,d-=mt,n.back+=mt,64&yt){t.msg="invalid distance code",n.mode=ct;break}n.offset=_t,n.extra=15&yt,n.mode=ot;case ot:if(n.extra){for(Et=n.extra;Et>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=ct;break}n.mode=at;case at:if(0===h)break t;if(m=g-h,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=ct;break}m>n.wnext?(m-=n.wnext,ft=n.wsize-m):ft=n.wnext-m,m>n.length&&(m=n.length),gt=n.window}else gt=o,ft=s-n.offset,m=n.length;m>h&&(m=h),h-=m,n.length-=m;do o[s++]=gt[ft++];while(--m);0===n.length&&(n.mode=nt);break;case st:if(0===h)break t;o[s++]=n.length,h--,n.mode=nt;break;case lt:if(n.wrap){for(;32>d;){if(0===l)break t;l--,p|=r[a++]<<d,d+=8}if(g-=h,t.total_out+=g,n.total+=g,g&&(t.adler=n.check=n.flags?v(n.check,o,g,s-g):_(n.check,o,g,s-g)),g=h,(n.flags?p:i(p))!==n.check){t.msg="incorrect data check",n.mode=ct;break}p=0,d=0}n.mode=ht;case ht:if(n.wrap&&n.flags){for(;32>d;){if(0===l)break t;l--,p+=r[a++]<<d,d+=8}if(p!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=ct;break}p=0,d=0}n.mode=ut;case ut:xt=C;break t;case ct:xt=X;break t;case pt:return A;case dt:default:return L}return t.next_out=s,t.avail_out=h,t.next_in=a,t.avail_in=l,n.hold=p,n.bits=d,(n.wsize||g!==t.avail_out&&n.mode<ct&&(n.mode<lt||e!==E))&&c(t,t.output,t.next_out,g-t.avail_out)?(n.mode=pt,A):(f-=t.avail_in,g-=t.avail_out,t.total_in+=f,t.total_out+=g,n.total+=g,n.wrap&&g&&(t.adler=n.check=n.flags?v(n.check,o,g,t.next_out-g):_(n.check,o,g,t.next_out-g)),t.data_type=n.bits+(n.last?64:0)+(n.mode===V?128:0)+(n.mode===et||n.mode===q?256:0),(0===f&&0===g||e===E)&&xt===T&&(xt=O),xt)}function d(t){if(!t||!t.state)return L;var e=t.state;return e.window&&(e.window=null),t.state=null,T}function f(t,e){var n;return t&&t.state?(n=t.state,0===(2&n.wrap)?L:(n.head=e,e.done=!1,T)):L}var g,m,y=t("../utils/common"),_=t("./adler32"),v=t("./crc32"),b=t("./inffast"),w=t("./inftrees"),P=0,x=1,M=2,E=4,k=5,S=6,T=0,C=1,G=2,L=-2,X=-3,A=-4,O=-5,I=8,D=1,N=2,R=3,z=4,B=5,F=6,j=7,U=8,$=9,W=10,H=11,V=12,Z=13,K=14,q=15,Y=16,J=17,Q=18,tt=19,et=20,nt=21,it=22,rt=23,ot=24,at=25,st=26,lt=27,ht=28,ut=29,ct=30,pt=31,dt=32,ft=852,gt=592,mt=15,yt=mt,_t=!0;n.inflateReset=a,n.inflateReset2=s,n.inflateResetKeep=o,n.inflateInit=h,n.inflateInit2=l,n.inflate=p,n.inflateEnd=d,n.inflateGetHeader=f,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(t,e,n){"use strict";var i=t("../utils/common"),r=15,o=852,a=592,s=0,l=1,h=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,f,g,m,y,_){var v,b,w,P,x,M,E,k,S,T=_.bits,C=0,G=0,L=0,X=0,A=0,O=0,I=0,D=0,N=0,R=0,z=null,B=0,F=new i.Buf16(r+1),j=new i.Buf16(r+1),U=null,$=0;for(C=0;r>=C;C++)F[C]=0;for(G=0;f>G;G++)F[e[n+G]]++;for(A=T,X=r;X>=1&&0===F[X];X--);if(A>X&&(A=X),0===X)return g[m++]=20971520,g[m++]=20971520,_.bits=1,0;for(L=1;X>L&&0===F[L];L++);for(L>A&&(A=L),D=1,C=1;r>=C;C++)if(D<<=1,D-=F[C],0>D)return-1;if(D>0&&(t===s||1!==X))return-1;for(j[1]=0,C=1;r>C;C++)j[C+1]=j[C]+F[C];for(G=0;f>G;G++)0!==e[n+G]&&(y[j[e[n+G]]++]=G);if(t===s?(z=U=y,M=19):t===l?(z=u,B-=257,U=c,$-=257,M=256):(z=p,U=d,M=-1),R=0,G=0,C=L,x=m,O=A,I=0,w=-1,N=1<<A,P=N-1,t===l&&N>o||t===h&&N>a)return 1;for(var W=0;;){W++,E=C-I,y[G]<M?(k=0,S=y[G]):y[G]>M?(k=U[$+y[G]],S=z[B+y[G]]):(k=96,S=0),v=1<<C-I,b=1<<O,L=b;do b-=v,g[x+(R>>I)+b]=E<<24|k<<16|S|0;while(0!==b);for(v=1<<C-1;R&v;)v>>=1;if(0!==v?(R&=v-1,R+=v):R=0,G++,0===--F[C]){if(C===X)break;C=e[n+y[G]]}if(C>A&&(R&P)!==w){for(0===I&&(I=A),x+=L,O=C-I,D=1<<O;X>O+I&&(D-=F[O+I],!(0>=D));)O++,D<<=1;if(N+=1<<O,t===l&&N>o||t===h&&N>a)return 1;w=R&P,g[w]=A<<24|O<<16|x-m|0}}return 0!==R&&(g[x+R]=C-I<<24|64<<16|0),_.bits=A,0}},{"../utils/common":27}],37:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(t,e,n){"use strict";function i(t){for(var e=t.length;--e>=0;)t[e]=0}function r(t){return 256>t?at[t]:at[256+(t>>>7)]}function o(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function a(t,e,n){t.bi_valid>V-n?(t.bi_buf|=e<<t.bi_valid&65535,o(t,t.bi_buf),t.bi_buf=e>>V-t.bi_valid,t.bi_valid+=n-V):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function s(t,e,n){a(t,n[2*e],n[2*e+1])}function l(t,e){var n=0;do n|=1&t,t>>>=1,n<<=1;while(--e>0);return n>>>1}function h(t){16===t.bi_valid?(o(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function u(t,e){var n,i,r,o,a,s,l=e.dyn_tree,h=e.max_code,u=e.stat_desc.static_tree,c=e.stat_desc.has_stree,p=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,f=e.stat_desc.max_length,g=0;for(o=0;H>=o;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;W>n;n++)i=t.heap[n],o=l[2*l[2*i+1]+1]+1,o>f&&(o=f,g++),l[2*i+1]=o,i>h||(t.bl_count[o]++,a=0,i>=d&&(a=p[i-d]),s=l[2*i],t.opt_len+=s*(o+a),c&&(t.static_len+=s*(u[2*i+1]+a)));if(0!==g){do{for(o=f-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[f]--,g-=2}while(g>0);for(o=f;0!==o;o--)for(i=t.bl_count[o];0!==i;)r=t.heap[--n],r>h||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),i--)}}function c(t,e,n){var i,r,o=new Array(H+1),a=0;for(i=1;H>=i;i++)o[i]=a=a+n[i-1]<<1;for(r=0;e>=r;r++){var s=t[2*r+1];0!==s&&(t[2*r]=l(o[s]++,s))}}function p(){var t,e,n,i,r,o=new Array(H+1);for(n=0,i=0;B-1>i;i++)for(lt[i]=n,t=0;t<1<<Q[i];t++)st[n++]=i;for(st[n-1]=i,r=0,i=0;16>i;i++)for(ht[i]=r,t=0;t<1<<tt[i];t++)at[r++]=i;for(r>>=7;U>i;i++)for(ht[i]=r<<7,t=0;t<1<<tt[i]-7;t++)at[256+r++]=i;for(e=0;H>=e;e++)o[e]=0;for(t=0;143>=t;)rt[2*t+1]=8,t++,o[8]++;for(;255>=t;)rt[2*t+1]=9,t++,o[9]++;for(;279>=t;)rt[2*t+1]=7,t++,o[7]++;for(;287>=t;)rt[2*t+1]=8,t++,o[8]++;for(c(rt,j+1,o),t=0;U>t;t++)ot[2*t+1]=5,ot[2*t]=l(t,5);ut=new dt(rt,Q,F+1,j,H),ct=new dt(ot,tt,0,U,H),pt=new dt(new Array(0),et,0,$,Z)}function d(t){var e;for(e=0;j>e;e++)t.dyn_ltree[2*e]=0;for(e=0;U>e;e++)t.dyn_dtree[2*e]=0;for(e=0;$>e;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*K]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function f(t){t.bi_valid>8?o(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function g(t,e,n,i){f(t),i&&(o(t,n),o(t,~n)),G.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}function m(t,e,n,i){var r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]}function y(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&m(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!m(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function _(t,e,n){var i,o,l,h,u=0;if(0!==t.last_lit)do i=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],o=t.pending_buf[t.l_buf+u],u++,0===i?s(t,o,e):(l=st[o],s(t,l+F+1,e),h=Q[l],0!==h&&(o-=lt[l],a(t,o,h)),i--,l=r(i),s(t,l,n),h=tt[l],0!==h&&(i-=ht[l],a(t,i,h)));while(u<t.last_lit);s(t,K,e)}function v(t,e){var n,i,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=W,n=0;l>n;n++)0!==o[2*n]?(t.heap[++t.heap_len]=h=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)r=t.heap[++t.heap_len]=2>h?++h:0,o[2*r]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=h,n=t.heap_len>>1;n>=1;n--)y(t,o,n);r=l;do n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],y(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*r]=o[2*n]+o[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=r,t.heap[1]=r++,y(t,o,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],u(t,e),c(o,h,t.bl_count)}function b(t,e,n){var i,r,o=-1,a=e[1],s=0,l=7,h=4;for(0===a&&(l=138,h=3),e[2*(n+1)+1]=65535,i=0;n>=i;i++)r=a,a=e[2*(i+1)+1],++s<l&&r===a||(h>s?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*q]++):10>=s?t.bl_tree[2*Y]++:t.bl_tree[2*J]++,s=0,o=r,0===a?(l=138,h=3):r===a?(l=6,h=3):(l=7,h=4))}function w(t,e,n){var i,r,o=-1,l=e[1],h=0,u=7,c=4;for(0===l&&(u=138,c=3),i=0;n>=i;i++)if(r=l,l=e[2*(i+1)+1],!(++h<u&&r===l)){if(c>h){do s(t,r,t.bl_tree);while(0!==--h)}else 0!==r?(r!==o&&(s(t,r,t.bl_tree),h--),s(t,q,t.bl_tree),a(t,h-3,2)):10>=h?(s(t,Y,t.bl_tree),a(t,h-3,3)):(s(t,J,t.bl_tree),a(t,h-11,7));h=0,o=r,0===l?(u=138,c=3):r===l?(u=6,c=3):(u=7,c=4)}}function P(t){var e;for(b(t,t.dyn_ltree,t.l_desc.max_code),b(t,t.dyn_dtree,t.d_desc.max_code),v(t,t.bl_desc),e=$-1;e>=3&&0===t.bl_tree[2*nt[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function x(t,e,n,i){var r;for(a(t,e-257,5),a(t,n-1,5),a(t,i-4,4),r=0;i>r;r++)a(t,t.bl_tree[2*nt[r]+1],3);w(t,t.dyn_ltree,e-1),w(t,t.dyn_dtree,n-1)}function M(t){var e,n=4093624447;for(e=0;31>=e;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return X;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return A;for(e=32;F>e;e++)if(0!==t.dyn_ltree[2*e])return A;return X}function E(t){gt||(p(),gt=!0),t.l_desc=new ft(t.dyn_ltree,ut),t.d_desc=new ft(t.dyn_dtree,ct),t.bl_desc=new ft(t.bl_tree,pt),t.bi_buf=0,t.bi_valid=0,d(t)}function k(t,e,n,i){a(t,(I<<1)+(i?1:0),3),g(t,e,n,!0)}function S(t){a(t,D<<1,3),s(t,K,rt),h(t)}function T(t,e,n,i){var r,o,s=0;t.level>0?(t.strm.data_type===O&&(t.strm.data_type=M(t)),v(t,t.l_desc),v(t,t.d_desc),s=P(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,r>=o&&(r=o)):r=o=n+5,r>=n+4&&-1!==e?k(t,e,n,i):t.strategy===L||o===r?(a(t,(D<<1)+(i?1:0),3),_(t,rt,ot)):(a(t,(N<<1)+(i?1:0),3),x(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),_(t,t.dyn_ltree,t.dyn_dtree)),d(t),i&&f(t)}function C(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(st[n]+F+1)]++,t.dyn_dtree[2*r(e)]++),t.last_lit===t.lit_bufsize-1}var G=t("../utils/common"),L=4,X=0,A=1,O=2,I=0,D=1,N=2,R=3,z=258,B=29,F=256,j=F+1+B,U=30,$=19,W=2*j+1,H=15,V=16,Z=7,K=256,q=16,Y=17,J=18,Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=512,rt=new Array(2*(j+2));i(rt);var ot=new Array(2*U);i(ot);var at=new Array(it);i(at);var st=new Array(z-R+1);i(st);var lt=new Array(B);i(lt);var ht=new Array(U);i(ht);var ut,ct,pt,dt=function(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length},ft=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e},gt=!1;n._tr_init=E,n._tr_stored_block=k,n._tr_flush_block=T,n._tr_tally=C,n._tr_align=S},{"../utils/common":27}],39:[function(t,e,n){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=i},{}]},{},[9])(9)}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ProgressBar=t()}}(function(){var t;return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,n,i){(function(){var e=this,r=function(){"use strict";function r(){}function o(t,e){var n;for(n in t)Object.hasOwnProperty.call(t,n)&&e(n)}function a(t,e){return o(e,function(n){t[n]=e[n]}),t}function s(t,e){o(e,function(n){"undefined"==typeof t[n]&&(t[n]=e[n])})}function l(t,e,n,i,r,o,a){var s,l,u,c=o>t?0:(t-o)/r;for(s in e)e.hasOwnProperty(s)&&(l=a[s],u="function"==typeof l?l:f[l],e[s]=h(n[s],i[s],u,c));return e}function h(t,e,n,i){return t+(e-t)*n(i)}function u(t,e){var n=d.prototype.filter,i=t._filterArgs;o(n,function(r){"undefined"!=typeof n[r][e]&&n[r][e].apply(t,i)})}function c(t,e,n,i,r,o,a,s,h,c,p){w=e+n+i,P=Math.min(p||b(),w),x=P>=w,M=i-(w-P),t.isPlaying()&&!x?(t._scheduleId=c(t._timeoutHandler,_),u(t,"beforeTween"),e+n>P?l(1,r,o,a,1,1,s):l(P,r,o,a,i,e+n,s),u(t,"afterTween"),h(r,t._attachment,M)):t.isPlaying()&&x&&(h(a,t._attachment,M),t.stop(!0))}function p(t,e){var n={},i=typeof e;return"string"===i||"function"===i?o(t,function(t){n[t]=e}):o(t,function(t){n[t]||(n[t]=e[t]||m)}),n}function d(t,e){this._currentState=t||{},this._configured=!1,this._scheduleFunction=g,"undefined"!=typeof e&&this.setConfig(e)}var f,g,m="linear",y=500,_=1e3/60,v=Date.now?Date.now:function(){return+new Date},b="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:v;g="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame||setTimeout:setTimeout;var w,P,x,M;return d.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._timestamp=b(),this._start(this.get(),this._attachment),this.resume())},d.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._attachment=t.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=t.delay||0,this._start=t.start||r,this._step=t.step||r,this._finish=t.finish||r,this._duration=t.duration||y,this._currentState=a({},t.from)||this.get(),this._originalState=this.get(),this._targetState=a({},t.to)||this.get();var e=this;this._timeoutHandler=function(){c(e,e._timestamp,e._delay,e._duration,e._currentState,e._originalState,e._targetState,e._easing,e._step,e._scheduleFunction)};var n=this._currentState,i=this._targetState;return s(i,n),this._easing=p(n,t.easing||m),this._filterArgs=[n,this._originalState,i,this._easing],u(this,"tweenCreated"),this},d.prototype.get=function(){return a({},this._currentState)},d.prototype.set=function(t){this._currentState=t},d.prototype.pause=function(){return this._pausedAtTime=b(),this._isPaused=!0,this},d.prototype.resume=function(){return this._isPaused&&(this._timestamp+=b()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},d.prototype.seek=function(t){t=Math.max(t,0);var e=b();return this._timestamp+t===0?this:(this._timestamp=e-t,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,c(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,e),this.pause()),this)},d.prototype.stop=function(t){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=r,(e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.oCancelAnimationFrame||e.msCancelAnimationFrame||e.mozCancelRequestAnimationFrame||e.clearTimeout)(this._scheduleId),t&&(u(this,"beforeTween"),l(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),u(this,"afterTween"),u(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},d.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},d.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},d.prototype.dispose=function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t]},d.prototype.filter={},d.prototype.formula={linear:function(t){return t}},f=d.prototype.formula,a(d,{now:b,each:o,tweenProps:l,tweenProp:h,applyFilter:u,shallowCopy:a,defaults:s,composeEasingObject:p}),"function"==typeof SHIFTY_DEBUG_NOW&&(e.timeoutHandler=c),"object"==typeof i?n.exports=d:"function"==typeof t&&t.amd?t(function(){return d}):"undefined"==typeof e.Tweenable&&(e.Tweenable=d),d}();!function(){r.shallowCopy(r.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},swingFrom:function(t){var e=1.70158;return t*t*((e+1)*t-e)},swingTo:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?2-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}})}(),function(){function t(t,e,n,i,r,o){function a(t){return((d*t+f)*t+g)*t}function s(t){return((m*t+y)*t+_)*t}function l(t){return(3*d*t+2*f)*t+g}function h(t){return 1/(200*t)}function u(t,e){return s(p(t,e))}function c(t){return t>=0?t:0-t}function p(t,e){var n,i,r,o,s,h;for(r=t,h=0;8>h;h++){if(o=a(r)-t,c(o)<e)return r;if(s=l(r),c(s)<1e-6)break;r-=o/s}if(n=0,i=1,r=t,n>r)return n;if(r>i)return i;for(;i>n;){if(o=a(r),c(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r}var d=0,f=0,g=0,m=0,y=0,_=0;return g=3*e,f=3*(i-e)-g,d=1-g-f,_=3*n,y=3*(r-n)-_,m=1-_-y,u(t,h(o))}function e(e,n,i,r){return function(o){return t(o,e,n,i,r,1)}}r.setBezierFunction=function(t,n,i,o,a){var s=e(n,i,o,a);return s.displayName=t,s.x1=n,s.y1=i,s.x2=o,s.y2=a,r.prototype.formula[t]=s},r.unsetBezierFunction=function(t){delete r.prototype.formula[t]}}(),function(){function t(t,e,n,i,o,a){return r.tweenProps(i,e,t,n,1,a,o)}var e=new r;e._filterArgs=[],r.interpolate=function(n,i,o,a,s){var l=r.shallowCopy({},n),h=s||0,u=r.composeEasingObject(n,a||"linear");e.set({});var c=e._filterArgs;c.length=0,c[0]=l,c[1]=n,c[2]=i,c[3]=u,r.applyFilter(e,"tweenCreated"),r.applyFilter(e,"beforeTween");var p=t(n,l,i,o,u,h);return r.applyFilter(e,"afterTween"),p}}(),function(t){function e(t,e){var n,i=[],r=t.length;for(n=0;r>n;n++)i.push("_"+e+"_"+n);return i}function n(t){var e=t.match(w);return e?(1===e.length||t[0].match(b))&&e.unshift(""):e=["",""],e.join(k)}function i(e){t.each(e,function(t){var n=e[t];"string"==typeof n&&n.match(E)&&(e[t]=r(n))})}function r(t){return l(E,t,o)}function o(t){var e=a(t);return"rgb("+e[0]+","+e[1]+","+e[2]+")"}function a(t){return t=t.replace(/#/,""),3===t.length&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),S[0]=s(t.substr(0,2)),S[1]=s(t.substr(2,2)),S[2]=s(t.substr(4,2)),S}function s(t){return parseInt(t,16)}function l(t,e,n){var i=e.match(t),r=e.replace(t,k);if(i)for(var o,a=i.length,s=0;a>s;s++)o=i.shift(),r=r.replace(k,n(o));return r}function h(t){return l(x,t,u)}function u(t){for(var e=t.match(P),n=e.length,i=t.match(M)[0],r=0;n>r;r++)i+=parseInt(e[r],10)+",";return i=i.slice(0,-1)+")"}function c(i){var r={};return t.each(i,function(t){var o=i[t];if("string"==typeof o){var a=y(o);r[t]={formatString:n(o),chunkNames:e(a,t)}}}),r}function p(e,n){t.each(n,function(t){for(var i=e[t],r=y(i),o=r.length,a=0;o>a;a++)e[n[t].chunkNames[a]]=+r[a];delete e[t]})}function d(e,n){t.each(n,function(t){var i=e[t],r=f(e,n[t].chunkNames),o=g(r,n[t].chunkNames);i=m(n[t].formatString,o),e[t]=h(i)})}function f(t,e){for(var n,i={},r=e.length,o=0;r>o;o++)n=e[o],i[n]=t[n],delete t[n];return i}function g(t,e){T.length=0;for(var n=e.length,i=0;n>i;i++)T.push(t[e[i]]);return T}function m(t,e){for(var n=t,i=e.length,r=0;i>r;r++)n=n.replace(k,+e[r].toFixed(4));return n}function y(t){return t.match(P)}function _(e,n){t.each(n,function(t){var i,r=n[t],o=r.chunkNames,a=o.length,s=e[t];if("string"==typeof s){var l=s.split(" "),h=l[l.length-1];for(i=0;a>i;i++)e[o[i]]=l[i]||h}else for(i=0;a>i;i++)e[o[i]]=s;delete e[t]})}function v(e,n){t.each(n,function(t){var i=n[t],r=i.chunkNames,o=r.length,a=e[r[0]],s=typeof a;if("string"===s){for(var l="",h=0;o>h;h++)l+=" "+e[r[h]],delete e[r[h]];e[t]=l.substr(1)}else e[t]=a})}var b=/(\d|\-|\.)/,w=/([^\-0-9\.]+)/g,P=/[0-9.\-]+/g,x=new RegExp("rgb\\("+P.source+/,\s*/.source+P.source+/,\s*/.source+P.source+"\\)","g"),M=/^.*\(/,E=/#([0-9]|[a-f]){3,6}/gi,k="VAL",S=[],T=[];t.prototype.filter.token={tweenCreated:function(t,e,n,r){i(t),i(e),i(n),this._tokenData=c(t)},beforeTween:function(t,e,n,i){_(i,this._tokenData),p(t,this._tokenData),p(e,this._tokenData),p(n,this._tokenData)},afterTween:function(t,e,n,i){d(t,this._tokenData),d(e,this._tokenData),d(n,this._tokenData),v(i,this._tokenData)}}}(r)}).call(null)},{}],2:[function(t,e,n){var i=t("./shape"),r=t("./utils"),o=function(t,e){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",i.apply(this,arguments)};o.prototype=new i,o.prototype.constructor=o,o.prototype._pathString=function(t){var e=t.strokeWidth;t.trailWidth&&t.trailWidth>t.strokeWidth&&(e=t.trailWidth);var n=50-e/2;return r.render(this._pathTemplate,{radius:n,"2radius":2*n})},o.prototype._trailString=function(t){return this._pathString(t)},e.exports=o},{"./shape":7,"./utils":8}],3:[function(t,e,n){var i=t("./shape"),r=t("./utils"),o=function(t,e){this._pathTemplate="M 0,{center} L 100,{center}",i.apply(this,arguments)};o.prototype=new i,o.prototype.constructor=o,o.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 "+e.strokeWidth),t.setAttribute("preserveAspectRatio","none")},o.prototype._pathString=function(t){return r.render(this._pathTemplate,{center:t.strokeWidth/2})},o.prototype._trailString=function(t){return this._pathString(t)},e.exports=o},{"./shape":7,"./utils":8}],4:[function(t,e,n){e.exports={Line:t("./line"),Circle:t("./circle"),SemiCircle:t("./semicircle"),Path:t("./path"),Shape:t("./shape"),utils:t("./utils")}},{"./circle":2,"./line":3,"./path":5,"./semicircle":6,"./shape":7,"./utils":8}],5:[function(t,e,n){var i=t("shifty"),r=t("./utils"),o={
easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},a=function(t,e){e=r.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},e);var n;n=r.isString(t)?document.querySelector(t):t,this.path=n,this._opts=e,this._tweenable=null;var i=this.path.getTotalLength();this.path.style.strokeDasharray=i+" "+i,this.set(0)};a.prototype.value=function(){var t=this._getComputedDashOffset(),e=this.path.getTotalLength(),n=1-t/e;return parseFloat(n.toFixed(6),10)},a.prototype.set=function(t){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(t);var e=this._opts.step;if(r.isFunction(e)){var n=this._easing(this._opts.easing),i=this._calculateTo(t,n),o=this._opts.shape||this;e(i,o,this._opts.attachment)}},a.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},a.prototype.animate=function(t,e,n){e=e||{},r.isFunction(e)&&(n=e,e={});var o=r.extend({},e),a=r.extend({},this._opts);e=r.extend(a,e);var s=this._easing(e.easing),l=this._resolveFromAndTo(t,s,o);this.stop(),this.path.getBoundingClientRect();var h=this._getComputedDashOffset(),u=this._progressToOffset(t),c=this;this._tweenable=new i,this._tweenable.tween({from:r.extend({offset:h},l.from),to:r.extend({offset:u},l.to),duration:e.duration,easing:s,step:function(t){c.path.style.strokeDashoffset=t.offset;var n=e.shape||c;e.step(t,n,e.attachment)},finish:function(t){r.isFunction(n)&&n()}})},a.prototype._getComputedDashOffset=function(){var t=window.getComputedStyle(this.path,null);return parseFloat(t.getPropertyValue("stroke-dashoffset"),10)},a.prototype._progressToOffset=function(t){var e=this.path.getTotalLength();return e-t*e},a.prototype._resolveFromAndTo=function(t,e,n){return n.from&&n.to?{from:n.from,to:n.to}:{from:this._calculateFrom(e),to:this._calculateTo(t,e)}},a.prototype._calculateFrom=function(t){return i.interpolate(this._opts.from,this._opts.to,this.value(),t)},a.prototype._calculateTo=function(t,e){return i.interpolate(this._opts.from,this._opts.to,t,e)},a.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable.dispose(),this._tweenable=null)},a.prototype._easing=function(t){return o.hasOwnProperty(t)?o[t]:t},e.exports=a},{"./utils":8,shifty:1}],6:[function(t,e,n){var i=t("./shape"),r=t("./circle"),o=t("./utils"),a=function(t,e){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",i.apply(this,arguments)};a.prototype=new i,a.prototype.constructor=a,a.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 50")},a.prototype._initializeTextElement=function(t,e,n){t.text.style&&(n.style.top="auto",n.style.bottom="0",t.text.alignToBottom?o.setStyle(n,"transform","translate(-50%, 0)"):o.setStyle(n,"transform","translate(-50%, 50%)"))},a.prototype._pathString=r.prototype._pathString,a.prototype._trailString=r.prototype._trailString,e.exports=a},{"./circle":2,"./shape":7,"./utils":8}],7:[function(t,e,n){var i=t("./path"),r=t("./utils"),o="Object is destroyed",a=function s(t,e){if(!(this instanceof s))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=r.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},alignToBottom:!0,value:"",className:"progressbar-text"},svgStyle:{display:"block",width:"100%"}},e,!0);var n,o=this._createSvgView(this._opts);if(n=r.isString(t)?document.querySelector(t):t,!n)throw new Error("Container does not exist: "+t);this._container=n,this._container.appendChild(o.svg),this._opts.svgStyle&&r.setStyles(o.svg,this._opts.svgStyle),this.text=null,this._opts.text.value&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.svg=o.svg,this.path=o.path,this.trail=o.trail;var a=r.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new i(o.path,a)}};a.prototype.animate=function(t,e,n){if(null===this._progressPath)throw new Error(o);this._progressPath.animate(t,e,n)},a.prototype.stop=function(){if(null===this._progressPath)throw new Error(o);void 0!==this._progressPath&&this._progressPath.stop()},a.prototype.destroy=function(){if(null===this._progressPath)throw new Error(o);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},a.prototype.set=function(t){if(null===this._progressPath)throw new Error(o);this._progressPath.set(t)},a.prototype.value=function(){if(null===this._progressPath)throw new Error(o);return void 0===this._progressPath?0:this._progressPath.value()},a.prototype.setText=function(t){if(null===this._progressPath)throw new Error(o);null===this.text&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.text.removeChild(this.text.firstChild),this.text.appendChild(document.createTextNode(t))},a.prototype._createSvgView=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(e,t);var n=null;(t.trailColor||t.trailWidth)&&(n=this._createTrail(t),e.appendChild(n));var i=this._createPath(t);return e.appendChild(i),{svg:e,path:i,trail:n}},a.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 100")},a.prototype._createPath=function(t){var e=this._pathString(t);return this._createPathElement(e,t)},a.prototype._createTrail=function(t){var e=this._trailString(t),n=r.extend({},t);return n.trailColor||(n.trailColor="#eee"),n.trailWidth||(n.trailWidth=n.strokeWidth),n.color=n.trailColor,n.strokeWidth=n.trailWidth,n.fill=null,this._createPathElement(e,n)},a.prototype._createPathElement=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),n.setAttribute("stroke",e.color),n.setAttribute("stroke-width",e.strokeWidth),e.fill?n.setAttribute("fill",e.fill):n.setAttribute("fill-opacity","0"),n},a.prototype._createTextElement=function(t,e){var n=document.createElement("p");n.appendChild(document.createTextNode(t.text.value));var i=t.text.style;return i&&(e.style.position="relative",r.setStyles(n,i),i.color||(n.style.color=t.color)),n.className=t.text.className,this._initializeTextElement(t,e,n),n},a.prototype._initializeTextElement=function(t,e,n){},a.prototype._pathString=function(t){throw new Error("Override this function for each progress bar")},a.prototype._trailString=function(t){throw new Error("Override this function for each progress bar")},e.exports=a},{"./path":5,"./utils":8}],8:[function(t,e,n){function i(t,e,n){t=t||{},e=e||{},n=n||!1;for(var r in e)if(e.hasOwnProperty(r)){var o=t[r],a=e[r];n&&c(o)&&c(a)?t[r]=i(o,a,n):t[r]=a}return t}function r(t,e){var n=t;for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],o="\\{"+i+"\\}",a=new RegExp(o,"g");n=n.replace(a,r)}return n}function o(t,e,n){for(var i=0;i<d.length;++i){var r=d[i];t.style[r+s(e)]=n}t.style[e]=n}function a(t,e){p(e,function(e,n){null!==e&&void 0!==e&&(c(e)&&e.prefix===!0?o(t,n,e.value):t.style[n]=e)})}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function l(t){return"string"==typeof t||t instanceof String}function h(t){return"function"==typeof t}function u(t){return"[object Array]"===Object.prototype.toString.call(t)}function c(t){if(u(t))return!1;var e=typeof t;return"object"===e&&!!t}function p(t,e){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e(i,n)}}var d="Webkit Moz O ms".split(" ");e.exports={extend:i,render:r,setStyle:o,setStyles:a,capitalize:s,isString:l,isFunction:h,isObject:c,forEachObject:p}},{}]},{},[4])(4)}),MapsGPX.plugin.FileClip={defaults:{classUl:"menu",classLabel:"menu-item",classLi:null},callback:function(t){var e,n=MapsGPX.merge({},MapsGPX.plugin.FileClip.defaults,t||{});return this.context.SidePanelControl?(this.context.FileClip?e=this.context.FileClip.getElementsByTagName("ul").item(0):(this.context.FileClip=document.createElement("div"),this.context.SidePanelControl.getElementDrawer().appendChild(this.context.FileClip),e=document.createElement("ul"),this.context.FileClip.appendChild(e),n.classUl&&(e.className=n.classUl)),this.addFilter("FileClip","onAppearOverlayShow",function(t,e){var n,i,r=this.context.FileClip.getElementsByTagName("input");for(n=0,i=r.length;i>n;++n)if(r.item(n).value==e)return r.item(n).checked?!1:!0;return!1}.bind(this)),void this.register("onAddGPX",function(t){var e,i,r,o;e=document.createElement("input"),e.setAttribute("type","checkbox"),e.setAttribute("value",t),e.checked=!0,google.maps.event.addDomListener(e,"change",function(t){t.target.checked?this.showOverlayGpxs(t.target.value):this.hideOverlayGpxs(t.target.value)}.bind(this)),o=t,new RegExp("([^/]+)$").test(o)&&(o=RegExp.$1),i=document.createElement("label"),i.appendChild(e),i.appendChild(document.createTextNode(o)),n.classLabel&&(i.className=n.classLabel),r=document.createElement("li"),r.appendChild(i),n.classLi&&(r.className=n.classLi),this.context.FileClip.getElementsByTagName("ul").item(0).appendChild(r)})):void console.log('The plugin "FileClip" requires "SidePanelControl"')}},MapsGPX.plugin.GeoLocation={watcher:null,options:{enableHighAccuracy:!1},callback:function(t){this.hook.onGetGeoLocation=this.hook.onGetGeoLocation||[],this.hook.onGetGeoLocationError=this.hook.onGetGeoLocationError||[],this.hook.onBeginWatchGeoLocation=this.hook.onBeginWatchGeoLocation||[],this.hook.onEndWatchGeoLocation=this.hook.onEndWatchGeoLocation||[],MapsGPX.prototype.isSupportedGeoLocation=function(){return navigator.geolocation?!0:!1},MapsGPX.prototype.isWatchingGeoLocation=function(){return MapsGPX.plugin.GeoLocation.watcher?!0:!1},MapsGPX.prototype.beginWatchGeoLocation=function(){var t=null;return MapsGPX.plugin.GeoLocation.watcher?t=!1:(MapsGPX.plugin.GeoLocation.watcher=navigator.geolocation.watchPosition(function(t){0!=this.hook.onGetGeoLocation.length&&this.applyHook("onGetGeoLocation",t)}.bind(this),function(t){console.error(t),0!=this.hook.onGetGeoLocationError.length&&this.applyHook("onGetGeoLocationError",t)}.bind(this),MapsGPX.plugin.GeoLocation.options),t=!0),0!=this.hook.onBeginWatchGeoLocation.length&&this.applyHook("onBeginWatchGeoLocation",t),t},MapsGPX.prototype.endWatchGeoLocation=function(){var t=null;return MapsGPX.plugin.GeoLocation.watcher?(navigator.geolocation.clearWatch(MapsGPX.plugin.GeoLocation.watcher),MapsGPX.plugin.GeoLocation.watcher=null,t=!0):t=!1,0!=this.hook.onEndWatchGeoLocation.length&&this.applyHook("onEndWatchGeoLocation",t),t}}},MapsGPX.plugin.GeoLocationControl={callback:function(t){var e,n,i;return i=function(){this.initialize.apply(this,arguments)},i.prototype={initialize:function(t){t=t||{},this.marker=null,this.circle=null,this.shown=!1},setMap:function(t){return this.marker&&this.marker.setMap(t),this.circle&&this.circle.setMap(t),t?this.shown=!0:this.shown=!1,this},isOverlayed:function(){return this.shown?!0:!1},reset:function(t){var e=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);return this.circle?(this.marker.setPosition(e),this.circle.setCenter(e)):(this.marker=new google.maps.Marker({clickable:!1,position:e,icon:new google.maps.MarkerImage([MapsGPX.plugin.GeoLocationControl.path,"gpsloc.png"].join("/"),new google.maps.Size(16,16),new google.maps.Point(0,0),new google.maps.Point(8,8))}),this.circle=new google.maps.Circle({center:e,clickable:!1,fillColor:"#CCCCFF",fillOpacity:.2,strokeColor:"#6666CC",strokeOpacity:.6,strokeWeight:2,radius:t.coords.accuracy||1})),e}},e=new i,n=new MapsGPX.MapControl({enabled:[MapsGPX.plugin.GeoLocationControl.path,"ic_location_searching_black_24dp.png"].join("/"),fixed:[MapsGPX.plugin.GeoLocationControl.path,"ic_gps_fixed_red_24dp.png"].join("/"),located:[MapsGPX.plugin.GeoLocationControl.path,"ic_gps_fixed_blue_24dp.png"].join("/"),failed:[MapsGPX.plugin.GeoLocationControl.path,"ic_gps_off_black_24dp.png"].join("/"),disabled:[MapsGPX.plugin.GeoLocationControl.path,"ic_location_disabled_black_24dp.png"].join("/")},{initial:"enabled"}),n.setMap(this.map),this.isSupportedGeoLocation()?(this.register("onBeginWatchGeoLocation",function(t){n.changeIcon("fixed")}.bind(this)),this.register("onEndWatchGeoLocation",function(t){n.changeIcon("enabled"),e.setMap(null)}.bind(this)),this.register("onGetGeoLocation",function(t){var i=e.reset(t);e.isOverlayed()||e.setMap(this.getMap()),n.isCurrentIcon("fixed")&&this.getMap().panTo(i)}.bind(this)),this.register("onGetGeoLocationError",function(t){n.changeIcon("failed"),e.setMap(null)}.bind(this)),google.maps.event.addDomListener(n.getElement(),"click",function(t){this.isWatchingGeoLocation()&&n.isCurrentIcon("fixed")?n.changeIcon("located"):this.isWatchingGeoLocation()?this.endWatchGeoLocation():this.beginWatchGeoLocation()}.bind(this)),void google.maps.event.addDomListener(this.getMap(),"dragstart",function(t){this.isWatchingGeoLocation()&&n.isCurrentIcon("fixed")&&n.changeIcon("located")}.bind(this))):void n.changeIcon("disabled")}},MapsGPX.plugin.InputFileControl={callback:function(t){var e,n;e=new MapsGPX.MapControl({initial:[MapsGPX.plugin.InputFileControl.path,"ic_folder_open_black_24dp.png"].join("/")},{position:"TOP_LEFT"}),e.setMap(this.map),n=document.createElement("input"),n.setAttribute("id",MapsGPX.plugin.InputFileControl.id),n.setAttribute("type","file"),n.setAttribute("style","display:none"),n.setAttribute("multiple",!0),google.maps.event.addDomListener(n,"change",function(t){var e,n,i=t.target.files;for(e=0,n=i.length;n>e;++e)this.input(i[e].name,i[e]).then(function(t){console.log(t)})}.bind(this)),google.maps.event.addDomListener(e.getElement(),"click",function(t){this.click()}.bind(n))}},MapsGPX.plugin.Milestone={bundles:["ExtDraggableObject.js","NodeOverlay.js","DivSign.js"],intervalDefinition:{mapping:{5:4e5,6:3e5,7:2e5,8:1e5,9:1e5,10:5e4,11:5e4,12:2e4,13:2e4,14:1e4,15:1e4,16:2e3,17:2e3,18:1e3,19:1e3},min_zoom:5,max_zoom:20,max_number_of_signs:100,min_interval_meters:100},getInterval:function(t,e){var n,i=MapsGPX.plugin.Milestone.intervalDefinition,r=parseInt(e)<i.max_zoom?i.mapping[e]:i.min_interval_meters,o=parseInt(t)/i.max_number_of_signs;if(o>=r)for(n=e-1;i.min_zoom<=n&&o>=r;--n)r=n<i.max_zoom?i.mapping[n]:i.min_interval_meters;return r},makeMilestones:function(t,e){var n,i,r={},o=t.getPath(),a=e,s=0;for(n=1,i=o.getLength();i>n;++n)s+=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(o.getAt(n-1).lat(),o.getAt(n-1).lng()),new google.maps.LatLng(o.getAt(n).lat(),o.getAt(n).lng())),s>=a&&(("undefined"==r[a]||null==r[a])&&(r[a]={order:a,index:n,distance:s}),a+=e);return r},callback:function(t){this.context.Milestone={},this.context.Milestone.trkLengthCache={shelf:{},genKey:function(t){return[t.object_id].join("	")},add:function(t,e){return this.shelf[this.genKey(e)]=t,this},get:function(t){return this.shelf[this.genKey(t)]}},this.context.Milestone.signCache={shelf:{},genKey:function(t,e){return[t.object_id,e].join("	")},add:function(t,e,n){return this.shelf[this.genKey(e,n)]=t,this},get:function(t,e){return this.shelf[this.genKey(t,e)]},hideAll:function(){for(var t in this.shelf)this.shelf[t].setMap(null);return this}},this.context.Milestone.stonesCache={shelf:{},genKey:function(t,e){return[t.object_id,e].join("	")},add:function(t,e,n){return this.shelf[this.genKey(e,n)]=t,this},get:function(t,e){return this.shelf[this.genKey(t,e)]}},google.maps.event.addListener(this.getMap(),"zoom_changed",function(){var t=this.getMap().getZoom();this.context.Milestone.signCache.hideAll(),t<MapsGPX.plugin.Milestone.intervalDefinition.min_zoom||this.eachGPX(function(t,e){var n,i,r,o,a,s,l,h;for(n=0,i=t.trk.length;i>n;++n)if(r=t.trk[n],r.overlay){trklength=this.app.context.Milestone.trkLengthCache.get(r.overlay),trklength||(trklength=r.overlay.computeDistanceTrack(0,r.overlay.getPath().getLength()-1),this.app.context.Milestone.trkLengthCache.add(r.overlay,trklength)),l=MapsGPX.plugin.Milestone.getInterval(trklength,this.zoom),a=this.app.context.Milestone.stonesCache.get(r.overlay,l),a||(a=MapsGPX.plugin.Milestone.makeMilestones(r.overlay,l),this.app.context.Milestone.stonesCache.add(a,r.overlay,l)),h=r.overlay.overlayed()?this.app.getMap():null;for(o in a)s=this.app.context.Milestone.signCache.get(r.overlay,a[o].index),s||(s=new NodeOverlay(DivSign.create(parseInt(a[o].distance/1e3)+" km",{contentStyle:{fontSize:"x-small",whiteSpace:"nowrap"}}),{position:r.overlay.getPath().getAt(a[o].index)}),this.app.context.Milestone.signCache.add(s,r.overlay,a[o].index)),s.setMap(h)}}.bind({app:this,zoom:t}))}.bind(this)),this.register("onShowPolyline",function(t){google.maps.event.trigger(this.getMap(),"zoom_changed")}.bind(this)),this.register("onHidePolyline",function(t){google.maps.event.trigger(this.getMap(),"zoom_changed")}.bind(this))}},NodeOverlay=function(t,e){var n=function(t,e){for(var n in e)t[n]=e[n];return t};this["super"]=google.maps.OverlayView.prototype,this.element=t,this["default"]={draggable:!1,anchorPosition:NodeOverlay.AnchorPosition.BOTTOM_CENTER,pane:NodeOverlay.MapPane.OVERLAY_IMAGE,draggableOptions:{}},this.settings=n(this["default"],e||{}),this.position=this.settings.position,this.draggable=null},NodeOverlay.prototype=Object.create(google.maps.OverlayView.prototype,{constructor:{value:NodeOverlay}}),NodeOverlay.NAME="NodeOverlay",NodeOverlay.VERSION="3.0.2",NodeOverlay.AnchorPosition={TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",TOP_CENTER:"topCenter",MIDDLE_LEFT:"middleLeft",MIDDLE_RIGHT:"middleRight",MIDDLE_CENTER:"middleCenter",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight",BOTTOM_CENTER:"bottomCenter"},NodeOverlay.MapPane={MAP_PANE:"mapPane",OVERLAY_LAYER:"overlayLayer",MARKER_LAYER:"markerLayer",OVERLAY_SHADOW:"overlayShadow",OVERLAY_IMAGE:"overlayImage",FLOAT_SHADOW:"floatShadow",OVERLAY_MOUSE_TARGET:"overlayMouseTarget",FLOAT_PANE:"floatPane"},NodeOverlay._getFunctionToComputeOffset=function(t){var e=function(t){return t/2};xl=function(t){return 0},xr=function(t){return t},yc=function(t){return t/2},yt=function(t){return 0},yb=function(t){return t};var n={};return n[NodeOverlay.AnchorPosition.TOP_LEFT]=function(t){return new google.maps.Size(xl(t.width),yt(t.height))},n[NodeOverlay.AnchorPosition.TOP_RIGHT]=function(t){return new google.maps.Size(xr(t.width),yt(t.height))},n[NodeOverlay.AnchorPosition.TOP_CENTER]=function(t){return new google.maps.Size(e(t.width),yt(t.height))},n[NodeOverlay.AnchorPosition.MIDDLE_LEFT]=function(t){return new google.maps.Size(xl(t.width),yc(t.height))},n[NodeOverlay.AnchorPosition.MIDDLE_RIGHT]=function(t){return new google.maps.Size(xr(t.width),yc(t.height))},n[NodeOverlay.AnchorPosition.MIDDLE_CENTER]=function(t){return new google.maps.Size(e(t.width),yc(t.height))},n[NodeOverlay.AnchorPosition.BOTTOM_LEFT]=function(t){return new google.maps.Size(xl(t.width),yb(t.height))},n[NodeOverlay.AnchorPosition.BOTTOM_RIGHT]=function(t){return new google.maps.Size(xr(t.width),yb(t.height))},n[NodeOverlay.AnchorPosition.BOTTOM_CENTER]=function(t){return new google.maps.Size(e(t.width),yb(t.height))},n[t]},NodeOverlay._createSizeOfElement=function(t){var e=t.style.display;if("none"!=e&&null!=e)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.style,i=n.visibility,r=n.position,o=n.display;n.visibility="hidden",n.position="absolute",n.display="block";var a=t.clientWidth,s=t.clientHeight;return n.display=o,n.position=r,n.visibility=i,new google.maps.Size(a,s)},NodeOverlay.prototype.getOffset=function(t){return NodeOverlay._getFunctionToComputeOffset(t)(NodeOverlay._createSizeOfElement(this.element))},NodeOverlay.prototype.getPane=function(){return this.getPanes()[this.settings.pane]},NodeOverlay.prototype.getPosition=function(){return this.position},NodeOverlay.prototype.getCurrentPoint=function(){var t=this.getOffset(this.settings.anchorPosition);return new google.maps.Point(parseInt(this.element.style.left)+t.width,parseInt(this.element.style.top)+t.height)},NodeOverlay.prototype.setPointByLatLng=function(t){var e=this.getProjection().fromLatLngToDivPixel(t),n=this.getOffset(this.settings.anchorPosition);return e.x=e.x-n.width,e.y=e.y-n.height,this.element.style.left=e.x+"px",this.element.style.top=e.y+"px",e},NodeOverlay.prototype.moveTo=function(t){return this.setPointByLatLng(t),this},NodeOverlay.prototype._handler_mouse_event=function(t){t.latLng=this.getPosition(),google.maps.event.trigger(this,t.type,t)},NodeOverlay.prototype._handler_drag_object_event=function(t){this.position=this.getProjection().fromDivPixelToLatLng(this.getCurrentPoint()),this.settings.marker&&this.settings.marker.setPosition(this.getPosition());var e=t.event.type;"mousedown"==t.event.type?e="dragstart":"mousemove"==t.event.type?e="drag":"mouseup"==t.event.type&&(e="dragend");var n=t.event;n.latLng=this.getPosition(),google.maps.event.trigger(this,e,n)},NodeOverlay.prototype._createDraggableObject=function(){this.draggable=new ExtDraggableObject(this.element,this.settings.draggableOptions),google.maps.event.addDomListener(this.draggable,"dragstart",this._handler_drag_object_event.bind(this)),google.maps.event.addDomListener(this.draggable,"drag",this._handler_drag_object_event.bind(this)),google.maps.event.addDomListener(this.draggable,"dragend",this._handler_drag_object_event.bind(this))},NodeOverlay.prototype.onAdd=function(){this.element.style||(this.element.style={}),this.element.style.position="absolute",this.getPane().appendChild(this.element),this.setPointByLatLng(this.getPosition()),google.maps.event.addDomListener(this.element,"click",this._handler_mouse_event.bind(this)),google.maps.event.addDomListener(this.element,"mousedown",this._handler_mouse_event.bind(this)),google.maps.event.addDomListener(this.element,"mouseup",this._handler_mouse_event.bind(this)),this.settings.draggable&&this._createDraggableObject(),this.settings.marker&&(this.settings.marker.setPosition(this.getPosition()),this.settings.marker.setMap(this.getMap())),this.element.style.visibility="visible"},NodeOverlay.prototype.onRemove=function(){this.settings.marker&&this.settings.marker.setMap(null),this.draggable&&google.maps.event.clearInstanceListeners(this.draggable),google.maps.event.clearInstanceListeners(this.element),this.element.style.visibility="hidden"},NodeOverlay.prototype.draw=function(){this.setPointByLatLng(this.getPosition())},NodeOverlay.prototype.setDraggableCursor=function(t){return this.draggable?(this.draggable.setDraggableCursor(t),!0):!1},NodeOverlay.prototype.setDraggingCursor=function(t){return this.draggable?(this.draggable.setDraggingCursor(t),!0):!1};var DivSign={NAME:"DivSign",VERSION:"3.0.0",createDivWrappingText:function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e},create:function(t,e){var n=function(t,e){for(var n in e)t[n]=e[n];return t},i={contentStyle:{},legStyle:{},maxWidth:"400px",opacity:"0.8"},r=n(i,e||{}),o=n({opacity:r.opacity,backgroundColor:"#FFFFFF",padding:"2px 1em",margin:"0",fontSize:"small",border:"1px solid #AAAAAA"},r.contentStyle||{}),a=n({opacity:r.opacity,margin:"0 auto 0 auto",textAlign:"center",backgroundColor:"#FFFFFF",padding:"0",border:"1px solid #AAAAAA",borderTop:"none",width:"3px",height:"5px"},r.legStyle||{}),s=this.createDivWrappingText(t);for(var l in o)s.style[l]=o[l];var h=document.createElement("div");h.style.textAlign="center",h.style.padding="0",h.appendChild(s);var u=document.createElement("div");for(var l in a)u.style[l]=a[l];var c=document.createElement("div");return c.style.overflow="hidden",c.style.width=r.width,r.maxWidth&&(c.style.maxWidth=r.maxWidth,c.style.setExpression&&c.style.setExpression("width",r.maxWidth<document.body.clientWidth?r.maxWidth:"auto")),c.appendChild(h),c.appendChild(u),c}};MapsGPX.plugin.QueryURL={callback:function(t){var e=MapsGPX.parseQueryString(location.search);e.url&&this.input(e.url,e.url)}},MapsGPX.plugin.SearchControl={bundles:["loader.css"],className:"map_control_input",callback:function(t){var e=document.createElement("input");e.setAttribute("class",MapsGPX.plugin.SearchControl.className),e.setAttribute("type","text"),e.setAttribute("placeholder","URL"),this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(e),google.maps.event.addDomListener(e,"change",function(t){var e=t.target.value.trim();""!=e&&this.input(e,e)}.bind(this))}},MapsGPX.plugin.SidePanelControl={templateOfId:"sidepanel",_sequence:0,generateId:function(){return this.templateOfId+""+ ++this._sequence},callback:function(t){var e,n,i;i=t||{effect:"slide",side:"LEFT",span:"75%"},e=new MapsGPX.MapControl({initial:[MapsGPX.plugin.SidePanelControl.path,"ic_list_black_24dp.png"].join("/")},{position:"LEFT_BOTTOM"}),e.setMap(this.map),n=new DrawerCSS(t.base_id||this.getMapElement().getAttribute("id"),t.drawer_id||MapsGPX.plugin.SidePanelControl.generateId(),i),google.maps.event.addDomListener(e.getElement(),"click",function(t){this.toggle()}.bind(n)),google.maps.event.addListener(this.getMap(),"click",function(t){this.close()}.bind(n)),this.context.SidePanelControl=n}},MapsGPX.plugin.ToggleOverlay={bundles:["loader.css"],class_prefix:"toggle-overlay-",callback:function(t){var e,n,i,r,o,a;return this.context.SidePanelControl?(e=function(t,e){var n;return n=document.createElement("input"),n.setAttribute("type","checkbox"),n.setAttribute("value",t),e&&(n.checked=!0),google.maps.event.addDomListener(n,"change",function(t){this.showOverlayGpxs()}.bind(this)),n}.bind(this),n=function(t){var e,n=t.getAttribute("value");return e=document.createElement("label"),e.setAttribute("class",MapsGPX.plugin.ToggleOverlay.class_prefix+n),e.appendChild(t),e.appendChild(document.createTextNode(n)),e}.bind(this),r=e("wpt",!0),o=e("rte",!0),a=e("trk",!0),i=document.createElement("div"),i.setAttribute("class",MapsGPX.plugin.ToggleOverlay.class_prefix+"container"),i.appendChild(n(r)),i.appendChild(n(o)),i.appendChild(n(a)),this.context.SidePanelControl.getElementDrawer().appendChild(i),void this.addFilter("ToggleOverlay","onAppearOverlayShow",function(t,e){return t.isWpt()?this.cb.wpt.checked?!1:!0:t.isRte()?this.cb.rte.checked?!1:!0:t.isTrk()?this.cb.trk.checked?!1:!0:!1}.bind({app:this,cb:{wpt:r,rte:o,trk:a}}))):void console.log('The plugin "ToggleOverlay" requires "SidePanelControl"')}},MapsGPX.plugin.VertexInfo={bundles:["MercatorProjection.js"],indexOfVertexNearestLatlng:function(t,e,n,i){var r,o,a,s,l,h,u,c,p,d,f,g,m,y=6378137,_=y,v=-1,b=5,w=180;for(o=0,a=e.getLength()-1;a>o;++o)r=new google.maps.LatLngBounds,r.extend(e.getAt(o)),r.extend(e.getAt(o+1)),r.extend(MercatorProjection.latlngFromOriginByPixel(t,r.getNorthEast(),b,-b,i)),r.extend(MercatorProjection.latlngFromOriginByPixel(t,r.getSouthWest(),-b,b,i)),r.contains(n)&&(h=e.getAt(o),u=n,c=e.getAt(o+1),p=u.lng()-h.lng(),d=u.lat()-h.lat(),f=c.lng()-h.lng(),g=c.lat()-h.lat(),m=Math.abs(Math.atan2(d,p)-Math.atan2(g,f)),_>m&&(_=m,v=o,w=google.maps.geometry.spherical.computeHeading(e.getAt(o),e.getAt(o+1))));return v>=0&&(s=google.maps.geometry.spherical.computeDistanceBetween(n,e.getAt(v)),l=google.maps.geometry.spherical.computeDistanceBetween(n,e.getAt(v+1)),v=l>s?v:v+1),v},callback:function(t){var e=new MercatorProjection;this.context.VertexInfo={projection:e},this.hook.onVertexInfo=this.hook.onVertexInfo||[],this.register("onCreatePolyline",function(t){t.addListener("click",function(e){var n=MapsGPX.plugin.VertexInfo.indexOfVertexNearestLatlng(this.app.context.VertexInfo.projection,this.polyline.getPath(),e.latLng,this.polyline.getMap().getZoom());0!=this.app.hook.onVertexInfo.length?this.app.applyHook("onVertexInfo",t,n,e):MapsGPX.plugin.VertexInfo._handlerHookOnClickPolylineDefault.call(this.app,t,n,e)}.bind({app:this,polyline:t}))}.bind(this))},_handlerHookOnClickPolylineDefault:function(t,e,n){var i,r;e>=0&&t.isTrk()&&(i=t.getSource()[e],r=["#",e,"<br/>lat=",i.lat,"<br/>lon=",i.lon],i.ele&&r.push("<br/>ele="+i.ele),i.time&&r.push("<br/>time="+i.time),new google.maps.InfoWindow({content:r.join(""),position:t.getPath().getAt(e)}).open(t.getMap()))}},MercatorProjection.TILE_SIZE=256,MercatorProjection.latlngFromOriginByPixel=function(t,e,n,i,r){var o,a,s,l,h,u;return t=t||new MercatorProjection,o=1<<r,a=t.fromLatLngToPoint(e),s=new google.maps.Point(a.x*o,a.y*o),l=new google.maps.Point(Math.floor(s.x/MercatorProjection.TILE_SIZE),Math.floor(s.y/MercatorProjection.TILE_SIZE)),h=a.x+n/o,u=a.y+i/o,t.fromPointToLatLng(new google.maps.Point(h,u))},MercatorProjection.bound=function(t,e,n){return null!=e&&(t=Math.max(t,e)),null!=n&&(t=Math.min(t,n)),t},MercatorProjection.degreesToRadians=function(t){return t*(Math.PI/180)},MercatorProjection.radiansToDegrees=function(t){return t/(Math.PI/180)},MercatorProjection.prototype.fromLatLngToPoint=function(t,e){var n,i;return n=e||new google.maps.Point(0,0),n.x=this.pixelOrigin_.x+t.lng()*this.pixelsPerLonDegree_,i=MercatorProjection.bound(Math.sin(MercatorProjection.degreesToRadians(t.lat())),-.9999,.9999),n.y=this.pixelOrigin_.y+.5*Math.log((1+i)/(1-i))*-this.pixelsPerLonRadian_,n},MercatorProjection.prototype.fromPointToLatLng=function(t){var e,n,i;return e=(t.x-this.pixelOrigin_.x)/this.pixelsPerLonDegree_,n=(t.y-this.pixelOrigin_.y)/-this.pixelsPerLonRadian_,i=MercatorProjection.radiansToDegrees(2*Math.atan(Math.exp(n))-Math.PI/2),new google.maps.LatLng(i,e)},MapsGPX.plugin.VertexInfoWindow={namespace:"VertexInfoWindow",templateOfId:"vertex-info-window-",_sequence:0,generateId:function(){return this.templateOfId+""+ ++this._sequence},pad:function(t,e){return(Math.pow(10,e)+parseInt(t)).toString().slice(-e)},_commify:function(t,e){if(t.match(/\..*\./)||t.match(/,/))return t;for(;e!=(e=e.replace(/^(-?\d+)(\d{3})/,"$1,$2")););return e},commify:function(t){return t.toString().replace(/([0-9\.,]+)/g,MapsGPX.plugin.VertexInfoWindow._commify)},generateContent:function(t,e,n){var i,r="",o="";return e.time&&(i=new Date(e.time),r=[[this.pad(i.getFullYear(),4),this.pad(i.getMonth()+1,2),this.pad(i.getDate(),2)].join("-"),[this.pad(i.getHours(),2),this.pad(i.getMinutes(),2),this.pad(i.getSeconds(),2)].join(":")].join(" ")),e.ele&&(o=parseInt(e.ele)),['<div class="info-window"><div id="',t,'" class="vertex">','  <div class="headline">','    <input type="radio" name="origin" value="',n,'" title="set origin"/> <span class="idx">',n,"</span>","  </div>",'  <div class="complex-type wpt-type">','    <div class="attribute"><span class="latlon lat">',e.lat,'</span>, <span class="latlon lon">',e.lon,"</span></div>",'    <div class="children"><span class="elevation">',o,"m</span></div>",'    <div class="children"><span class="timestamp">',r,"</span></div>","  </div>",'  <div class="measure">',"   &nbsp;","  </div>","</div></div>"].join("")},callback:function(t){this.context.VertexInfoWindow={_active:null,getActiveInfoWindow:function(){return this._active},setActiveInfoWindow:function(t,e){this._active=t,e&&t.setZIndex(this.getHigherZIndex())},isActiveInfoWindow:function(t){return this._active===t},_maxZindex:0,getHigherZIndex:function(){return++this._maxZindex}},google.maps.event.addDomListener(document,"keydown",function(t){var e,n,i=this.context.VertexInfoWindow,r=i.getActiveInfoWindow();if(null!=r){if(e=r.get("VertexInfoWindow"),39==t.keyCode&&e.index<e.polyline.getPath().getLength()-1)e.index+=1;else{if(!(37==t.keyCode&&0<e.index))return;e.index-=1}r.set("VertexInfoWindow",e),n=e.polyline.getPath().getAt(e.index),t.shiftKey&&e.polyline.getMap().panTo(n),r.setPosition(n),r.setContent(MapsGPX.plugin.VertexInfoWindow.generateContent(e.id,e.polyline.getSource()[e.index],e.index))}}.bind(this)),this.register("onVertexInfo",function(t,e,n){var i,r,o=this.context.VertexInfoWindow;e>=0&&t.isTrk()&&(i=MapsGPX.plugin.VertexInfoWindow.generateId(),r=new google.maps.InfoWindow({content:MapsGPX.plugin.VertexInfoWindow.generateContent(i,t.getSource()[e],e),position:t.getPath().getAt(e)}),r.set("VertexInfoWindow",{context:o,id:i,index:e,polyline:t}),google.maps.event.addListener(r,"domready",function(e){
var n,i,r,o,a,s,l,h,u,c,p=document.getElementById(this.get("VertexInfoWindow").id),d=this.get("VertexInfoWindow").context,f=null;for(d.setActiveInfoWindow(this,!0),google.maps.event.addDomListener(p,"click",function(t){this.get("VertexInfoWindow").context.setActiveInfoWindow(this,!0)}.bind(this)),n=document.getElementsByClassName("vertex"),r=0,o=n.length;o>r;++r)if(i=n.item(r).getElementsByTagName("input").item(0),"radio"==i.type&&i.checked){f=i.value;break}f&&p!==n.item(r)&&(a=p.getElementsByTagName("input").item(0).value,s=t.computeDistanceTrack(f,a),l="",h="",u=this.get("VertexInfoWindow").polyline.getSource(),c="",u[f].time&&u[a].time&&(c=(new Date(u[a].time)-new Date(u[f].time))/1e3,l=Math.round(c/60),h=0!=c?Math.abs(Math.round(s/1e3/(c/60/60)*10)/10).toString()+" km/h":"0 km/h"),p.getElementsByClassName("measure").item(0).innerHTML=[MapsGPX.plugin.VertexInfoWindow.commify(Math.round(s))," meters",l," mins",h].join(", "))}),google.maps.event.addListener(r,"closeclick",function(){this.get("VertexInfoWindow").context.isActiveInfoWindow(this)&&this.get("VertexInfoWindow").context.setActiveInfoWindow(null),this.set("VertexInfoWindow",null),google.maps.event.clearInstanceListeners(this)}),r.open(t.getMap()))})}};